<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–º–Ω—ã–π –±—É–¥–∏–ª—å–Ω–∏–∫ | –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è + –í—Ä–µ–º—è</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        :root {
            --primary: #4A6FA5;
            --secondary: #2E5077;
            --accent: #FF6B6B;
            --dark: #1A2D42;
            --light: #F5F7FA;
            --success: #4ECDC4;
            --warning: #FFD166;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Montserrat', 'Segoe UI', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--dark) 0%, #0F1A2B 100%);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
            padding: 10px;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        header {
            text-align: center;
            padding: 20px 15px;
            background: rgba(26, 45, 66, 0.7);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(74, 111, 165, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent), var(--success));
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            letter-spacing: 0.5px;
        }
        
        .tagline {
            font-size: 1rem;
            max-width: 100%;
            margin: 0 auto;
            color: rgba(245, 247, 250, 0.8);
            line-height: 1.5;
        }
        
        .notification-permission {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid var(--accent);
            border-radius: 10px;
            padding: 12px 15px;
            margin: 10px 0;
            text-align: center;
            font-size: 0.9rem;
        }
        
        .notification-permission button {
            background: var(--accent);
            margin-top: 8px;
        }
        
        .tabs {
            display: flex;
            background: rgba(26, 45, 66, 0.7);
            border-radius: 12px;
            padding: 3px;
            margin-bottom: 15px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .tab {
            flex: 1;
            padding: 12px 8px;
            text-align: center;
            background: transparent;
            border: none;
            color: var(--light);
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            min-width: 140px;
        }
        
        .tab.active {
            background: var(--primary);
            box-shadow: 0 3px 10px rgba(74, 111, 165, 0.4);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .map-container {
            width: 100%;
            height: 300px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
            position: relative;
            border: 1px solid rgba(74, 111, 165, 0.3);
        }
        
        #map {
            height: 100%;
            width: 100%;
            border-radius: 15px;
        }
        
        .map-overlay {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(26, 45, 66, 0.9);
            padding: 8px 15px;
            border-radius: 50px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(5px);
            border: 1px solid var(--primary);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            font-size: 0.9rem;
        }
        
        .location-controls {
            position: absolute;
            bottom: 15px;
            right: 10px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }
        
        .location-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--primary);
            border: none;
            color: white;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .location-btn:active {
            transform: scale(0.95);
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--success);
            animation: pulse 2s infinite;
        }
        
        .controls {
            width: 100%;
            background: rgba(26, 45, 66, 0.7);
            padding: 20px 15px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(74, 111, 165, 0.2);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .section-title {
            font-size: 1.1rem;
            margin-bottom: 5px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .section-title::before {
            content: '';
            width: 4px;
            height: 16px;
            background: var(--accent);
            border-radius: 2px;
        }
        
        label {
            font-weight: bold;
            font-size: 0.95rem;
            color: rgba(245, 247, 250, 0.9);
        }
        
        input, select, textarea, button {
            padding: 14px 16px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            background: rgba(245, 247, 250, 0.1);
            color: var(--light);
            border: 1px solid rgba(74, 111, 165, 0.3);
            transition: all 0.3s ease;
            width: 100%;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(74, 111, 165, 0.2);
        }
        
        input::placeholder, textarea::placeholder {
            color: rgba(245, 247, 250, 0.5);
        }
        
        .range-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .range-value {
            min-width: 50px;
            text-align: center;
            font-weight: bold;
            background: var(--primary);
            padding: 5px 8px;
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        button {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 8px;
            position: relative;
            overflow: hidden;
            font-size: 1rem;
            letter-spacing: 0.5px;
            padding: 16px;
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: 0.5s;
        }
        
        button:hover::before {
            left: 100%;
        }
        
        button:active {
            transform: translateY(2px);
        }
        
        button:disabled {
            background: rgba(245, 247, 250, 0.1);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        button:disabled::before {
            display: none;
        }
        
        .status-panel {
            padding: 15px;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.3);
            margin-top: 8px;
            border-left: 3px solid var(--primary);
            font-size: 0.9rem;
        }
        
        .alarm-active {
            animation: alarm-pulse 1.5s infinite;
            border-left-color: var(--accent);
            background: rgba(255, 107, 107, 0.2);
        }
        
        .distance-info {
            font-size: 1.2rem;
            font-weight: bold;
            text-align: center;
            padding: 12px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 1px solid rgba(74, 111, 165, 0.3);
            margin: 8px 0;
            position: relative;
            overflow: hidden;
        }
        
        .distance-info::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(74, 111, 165, 0.1), transparent);
            transform: translateX(-100%);
        }
        
        .distance-info.active::before {
            animation: shimmer 3s infinite;
        }
        
        .alarms-list {
            max-height: 200px;
            overflow-y: auto;
            padding: 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .alarm-item {
            padding: 10px 12px;
            background: rgba(74, 111, 165, 0.1);
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(74, 111, 165, 0.3);
        }
        
        .alarm-name {
            font-weight: bold;
            font-size: 0.95rem;
        }
        
        .alarm-details {
            font-size: 0.8rem;
            color: rgba(245, 247, 250, 0.7);
        }
        
        .active-alarm {
            background: rgba(78, 205, 196, 0.15);
            border-color: rgba(78, 205, 196, 0.5);
        }
        
        footer {
            text-align: center;
            padding: 15px;
            margin-top: 15px;
            font-size: 0.8rem;
            opacity: 0.7;
            border-top: 1px solid rgba(74, 111, 165, 0.2);
        }
        
        .current-time {
            font-size: 1.3rem;
            text-align: center;
            padding: 12px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin: 8px 0;
            font-weight: bold;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .action-buttons button {
            flex: 1;
        }
        
        .user-location-marker {
            background: var(--accent);
            border: 3px solid white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            box-shadow: 0 0 10px var(--accent);
            animation: pulse 2s infinite;
        }
        
        .custom-sounds-section {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
        }
        
        .custom-sounds-list {
            max-height: 150px;
            overflow-y: auto;
            margin: 10px 0;
        }
        
        .custom-sound-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 10px;
            background: rgba(74, 111, 165, 0.1);
            border-radius: 8px;
            margin-bottom: 8px;
        }
        
        .sound-name {
            font-size: 0.9rem;
        }
        
        .sound-controls {
            display: flex;
            gap: 5px;
        }
        
        .sound-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--primary);
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .file-upload-container {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .file-upload-label {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 12px;
            background: rgba(74, 111, 165, 0.2);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            text-align: center;
        }
        
        #audioUpload {
            display: none;
        }
        
        .notification-settings {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .notification-settings label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .notification-settings input[type="checkbox"] {
            width: 20px;
            height: 20px;
        }
        
        .missed-notifications {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid var(--accent);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .missed-notifications h3 {
            color: var(--accent);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .missed-notification-item {
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .missed-notification-time {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        @keyframes alarm-pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 107, 107, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0); }
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        /* –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-width: 360px) {
            h1 {
                font-size: 1.5rem;
            }
            
            .tab {
                font-size: 0.8rem;
                min-width: 120px;
                padding: 10px 6px;
            }
            
            .map-overlay {
                font-size: 0.8rem;
                padding: 6px 12px;
            }
            
            input, select, textarea, button {
                padding: 12px 14px;
            }
        }
        
        /* –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è */
        @media (min-width: 768px) and (max-height: 500px) {
            .container {
                max-width: 100%;
            }
            
            .map-container {
                height: 400px;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header>
            <h1>–£–ú–ù–´–ô –ë–£–î–ò–õ–¨–ù–ò–ö</h1>
            <p class="tagline">–°–∏–≥–Ω–∞–ª—ã –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—é —Å –∑–∞–ø–∏—Å—å—é –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</p>
            
            <div class="notification-permission" id="notificationPermission" style="display: none;">
                <p>–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Ä–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ</p>
                <button id="enableNotificationsBtn">–†–∞–∑—Ä–µ—à–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</button>
            </div>
        </header>
        
        <div class="missed-notifications" id="missedNotifications" style="display: none;">
            <h3>üì´ –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
            <div id="missedNotificationsList"></div>
            <button id="clearMissedNotificationsBtn" style="margin-top: 10px;">–û—á–∏—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫</button>
        </div>
        
        <div class="tabs">
            <button class="tab active" data-tab="location">–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è</button>
            <button class="tab" data-tab="time">–ü–æ –≤—Ä–µ–º–µ–Ω–∏</button>
            <button class="tab" data-tab="sounds">–ú–æ–∏ –∑–≤—É–∫–∏</button>
        </div>
        
        <div class="map-container">
            <div id="map"></div>
            <div class="map-overlay">
                <div class="status-dot"></div>
                <span>–°–∏–≥–Ω–∞–ª–æ–≤: <span id="activeAlarmsCount">0</span></span>
            </div>
            <div class="location-controls">
                <button class="location-btn" id="locateUser" title="–ù–∞–π—Ç–∏ –º–µ–Ω—è">üìç</button>
                <button class="location-btn" id="trackUser" title="–°–ª–µ–¥–∏—Ç—å –∑–∞ –º–Ω–æ–π">üëÅÔ∏è</button>
            </div>
        </div>
        
        <div class="controls">
            <div class="tab-content active" id="location-tab">
                <div class="control-group">
                    <div class="section-title">–ì–µ–æ–ª–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∏–≥–Ω–∞–ª</div>
                    
                    <label for="alarmName">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                    <input type="text" id="alarmName" placeholder="–†–∞–±–æ—Ç–∞, –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞...">
                    
                    <label for="alarmRadius">–†–∞–¥–∏—É—Å (–º–µ—Ç—Ä—ã):</label>
                    <div class="range-container">
                        <input type="range" id="alarmRadius" min="50" max="2000" value="300">
                        <div class="range-value" id="radiusValue">300 –º</div>
                    </div>
                    
                    <label for="alarmSound">–¢–∏–ø —Å–∏–≥–Ω–∞–ª–∞:</label>
                    <select id="alarmSound">
                        <option value="standard">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π</option>
                        <option value="melodic">–ú–µ–ª–æ–¥–∏—á–Ω—ã–π</option>
                        <option value="vibration">–í–∏–±—Ä–∞—Ü–∏—è</option>
                        <option value="custom">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∑–≤—É–∫</option>
                    </select>
                    
                    <label for="alarmMessage">–°–æ–æ–±—â–µ–Ω–∏–µ:</label>
                    <textarea id="alarmMessage" placeholder="–¢–µ–∫—Å—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è..." rows="2"></textarea>
                    
                    <div class="notification-settings">
                        <label>
                            <input type="checkbox" id="locationNotification" checked>
                            –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                        </label>
                    </div>
                    
                    <button id="createAlarmBtn">–°–æ–∑–¥–∞—Ç—å –≥–µ–æ—Å–∏–≥–Ω–∞–ª</button>
                </div>
            </div>
            
            <div class="tab-content" id="time-tab">
                <div class="control-group">
                    <div class="section-title">–í—Ä–µ–º–µ–Ω–Ω–æ–π –±—É–¥–∏–ª—å–Ω–∏–∫</div>
                    
                    <label for="timeAlarmName">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                    <input type="text" id="timeAlarmName" placeholder="–ü–æ–¥—ä–µ–º, –û–±–µ–¥...">
                    
                    <label for="alarmTime">–í—Ä–µ–º—è:</label>
                    <input type="time" id="alarmTime">
                    
                    <label for="repeatDays">–ü–æ–≤—Ç–æ—Ä:</label>
                    <select id="repeatDays">
                        <option value="once">–û–¥–∏–Ω —Ä–∞–∑</option>
                        <option value="daily">–ï–∂–µ–¥–Ω–µ–≤–Ω–æ</option>
                        <option value="weekdays">–ü–æ –±—É–¥–Ω—è–º</option>
                        <option value="weekends">–ü–æ –≤—ã—Ö–æ–¥–Ω—ã–º</option>
                    </select>
                    
                    <label for="timeAlarmSound">–¢–∏–ø —Å–∏–≥–Ω–∞–ª–∞:</label>
                    <select id="timeAlarmSound">
                        <option value="standard">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π</option>
                        <option value="melodic">–ú–µ–ª–æ–¥–∏—á–Ω—ã–π</option>
                        <option value="vibration">–í–∏–±—Ä–∞—Ü–∏—è</option>
                        <option value="custom">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∑–≤—É–∫</option>
                    </select>
                    
                    <label for="timeAlarmMessage">–°–æ–æ–±—â–µ–Ω–∏–µ:</label>
                    <textarea id="timeAlarmMessage" placeholder="–¢–µ–∫—Å—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è..." rows="2"></textarea>
                    
                    <div class="notification-settings">
                        <label>
                            <input type="checkbox" id="timeNotification" checked>
                            –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                        </label>
                    </div>
                    
                    <button id="createTimeAlarmBtn">–°–æ–∑–¥–∞—Ç—å –±—É–¥–∏–ª—å–Ω–∏–∫</button>
                </div>
            </div>
            
            <div class="tab-content" id="sounds-tab">
                <div class="control-group">
                    <div class="section-title">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–≤—É–∫–æ–≤</div>
                    
                    <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–≤–æ–∏ –∑–≤—É–∫–∏ –¥–ª—è –±—É–¥–∏–ª—å–Ω–∏–∫–æ–≤ (MP3, WAV, OGG)</p>
                    
                    <div class="file-upload-container">
                        <label for="audioUpload" class="file-upload-label">
                            üìÅ –í—ã–±—Ä–∞—Ç—å –∑–≤—É–∫–æ–≤–æ–π —Ñ–∞–π–ª
                        </label>
                        <input type="file" id="audioUpload" accept="audio/*">
                        <button id="uploadSoundBtn">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                    </div>
                    
                    <div class="custom-sounds-section">
                        <div class="section-title">–ú–æ–∏ –∑–≤—É–∫–∏</div>
                        <div class="custom-sounds-list" id="customSoundsList">
                            <div class="custom-sound-item">
                                <span class="sound-name">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∑–≤—É–∫–æ–≤</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="control-group">
                <div class="section-title">–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è</div>
                <div class="current-time" id="currentTime">--:--:--</div>
            </div>
            
            <div class="control-group">
                <div class="section-title">–ú–æ–∏ —Å–∏–≥–Ω–∞–ª—ã</div>
                <div class="alarms-list" id="alarmsList">
                    <div class="alarm-item">
                        <span class="alarm-name">–ü–æ–∫–∞ –Ω–µ—Ç —Å–∏–≥–Ω–∞–ª–æ–≤</span>
                    </div>
                </div>
            </div>
            
            <div class="control-group">
                <div class="section-title">–ù–∞–≤–∏–≥–∞—Ü–∏—è</div>
                
                <label>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</label>
                <div class="status-panel" id="locationStatus">–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è...</div>
                
                <label>–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ü–µ–ª–∏:</label>
                <div class="distance-info" id="distanceInfo">-</div>
                
                <label>–°—Ç–∞—Ç—É—Å:</label>
                <div class="status-panel" id="alarmStatus">–°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞</div>
                
                <div class="action-buttons">
                    <button id="clearAlarmsBtn">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ</button>
                    <button id="testAlarmBtn">–¢–µ—Å—Ç —Å–∏–≥–Ω–∞–ª–∞</button>
                </div>
            </div>
        </div>
        
        <footer>
            <p>–£–º–Ω—ã–π –±—É–¥–∏–ª—å–Ω–∏–∫ &copy; 2023 | –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ</p>
        </footer>
    </div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
        const map = L.map('map').setView([55.7558, 37.6173], 13);
        
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        let userMarker = null;
        let userAccuracyCircle = null;
        let alarms = [];
        let customSounds = [];
        let missedNotifications = [];
        let watchId = null;
        let closestAlarm = null;
        let currentTimeInterval = null;
        let isTracking = false;
        let selectedFile = null;
        let notificationPermission = false;
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const locationStatus = document.getElementById('locationStatus');
        const distanceInfo = document.getElementById('distanceInfo');
        const alarmStatus = document.getElementById('alarmStatus');
        const createAlarmBtn = document.getElementById('createAlarmBtn');
        const createTimeAlarmBtn = document.getElementById('createTimeAlarmBtn');
        const clearAlarmsBtn = document.getElementById('clearAlarmsBtn');
        const testAlarmBtn = document.getElementById('testAlarmBtn');
        const locateUserBtn = document.getElementById('locateUser');
        const trackUserBtn = document.getElementById('trackUser');
        const uploadSoundBtn = document.getElementById('uploadSoundBtn');
        const audioUpload = document.getElementById('audioUpload');
        const enableNotificationsBtn = document.getElementById('enableNotificationsBtn');
        const notificationPermissionDiv = document.getElementById('notificationPermission');
        const missedNotificationsDiv = document.getElementById('missedNotifications');
        const missedNotificationsList = document.getElementById('missedNotificationsList');
        const clearMissedNotificationsBtn = document.getElementById('clearMissedNotificationsBtn');
        const alarmRadius = document.getElementById('alarmRadius');
        const radiusValue = document.getElementById('radiusValue');
        const alarmsList = document.getElementById('alarmsList');
        const customSoundsList = document.getElementById('customSoundsList');
        const activeAlarmsCount = document.getElementById('activeAlarmsCount');
        const currentTime = document.getElementById('currentTime');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage
        function loadData() {
            const savedAlarms = localStorage.getItem('alarms');
            const savedSounds = localStorage.getItem('customSounds');
            const savedMissed = localStorage.getItem('missedNotifications');
            
            if (savedAlarms) {
                alarms = JSON.parse(savedAlarms);
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∞—Ä–∫–µ—Ä—ã –Ω–∞ –∫–∞—Ä—Ç–µ –¥–ª—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –±—É–¥–∏–ª—å–Ω–∏–∫–æ–≤
                alarms.forEach(alarm => {
                    if (alarm.type === 'location') {
                        // –°–æ–∑–¥–∞–µ–º –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞
                        alarm.circle = L.circle(alarm.latlng, {
                            color: '#4A6FA5',
                            fillColor: '#4A6FA5',
                            fillOpacity: 0.2,
                            radius: alarm.radius
                        }).addTo(map);
                        
                        alarm.marker = L.marker(alarm.latlng).addTo(map).bindPopup(`
                            <div style="text-align: center; padding: 10px;">
                                <h3 style="margin: 0 0 10px 0; color: #4A6FA5;">${alarm.name}</h3>
                                <p style="margin: 0;">${alarm.message}</p>
                                <p style="margin: 10px 0 0 0; font-size: 0.9em; color: #777;">–†–∞–¥–∏—É—Å: ${alarm.radius} –º</p>
                            </div>
                        `);
                    }
                });
                updateAlarmsList();
            }
            
            if (savedSounds) {
                customSounds = JSON.parse(savedSounds);
                updateCustomSoundsList();
            }
            
            if (savedMissed) {
                missedNotifications = JSON.parse(savedMissed);
                updateMissedNotifications();
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ localStorage
        function saveData() {
            // –£–¥–∞–ª—è–µ–º —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
            const alarmsToSave = alarms.map(alarm => {
                const { circle, marker, ...alarmData } = alarm;
                return alarmData;
            });
            
            localStorage.setItem('alarms', JSON.stringify(alarmsToSave));
            localStorage.setItem('customSounds', JSON.stringify(customSounds));
            localStorage.setItem('missedNotifications', JSON.stringify(missedNotifications));
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function updateMissedNotifications() {
            if (missedNotifications.length === 0) {
                missedNotificationsDiv.style.display = 'none';
                return;
            }
            
            missedNotificationsDiv.style.display = 'block';
            missedNotificationsList.innerHTML = '';
            
            missedNotifications.forEach((notification, index) => {
                const notificationElement = document.createElement('div');
                notificationElement.className = 'missed-notification-item';
                notificationElement.innerHTML = `
                    <div>
                        <div><strong>${notification.title}</strong></div>
                        <div>${notification.message}</div>
                        <div class="missed-notification-time">${new Date(notification.timestamp).toLocaleString()}</div>
                    </div>
                    <button class="delete-missed-notification" data-index="${index}" title="–£–¥–∞–ª–∏—Ç—å">√ó</button>
                `;
                missedNotificationsList.appendChild(notificationElement);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —É–¥–∞–ª–µ–Ω–∏—è
            document.querySelectorAll('.delete-missed-notification').forEach(button => {
                button.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    deleteMissedNotification(index);
                });
            });
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function deleteMissedNotification(index) {
            if (index >= 0 && index < missedNotifications.length) {
                missedNotifications.splice(index, 1);
                saveData();
                updateMissedNotifications();
            }
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        clearMissedNotificationsBtn.addEventListener('click', function() {
            if (missedNotifications.length === 0) return;
            
            if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è?")) {
                missedNotifications = [];
                saveData();
                updateMissedNotifications();
            }
        });
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function addMissedNotification(title, message) {
            const notification = {
                title: title,
                message: message,
                timestamp: Date.now()
            };
            
            missedNotifications.unshift(notification);
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            if (missedNotifications.length > 50) {
                missedNotifications = missedNotifications.slice(0, 50);
            }
            
            saveData();
            updateMissedNotifications();
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∑–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function checkNotificationPermission() {
            if (!("Notification" in window)) {
                console.log("–ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è");
                return;
            }
            
            if (Notification.permission === "granted") {
                notificationPermission = true;
                notificationPermissionDiv.style.display = 'none';
            } else if (Notification.permission === "denied") {
                notificationPermission = false;
                notificationPermissionDiv.style.display = 'block';
            } else {
                notificationPermission = false;
                notificationPermissionDiv.style.display = 'block';
            }
        }
        
        // –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function requestNotificationPermission() {
            if (!("Notification" in window)) {
                alert("–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è");
                return;
            }
            
            Notification.requestPermission().then(function(permission) {
                if (permission === "granted") {
                    notificationPermission = true;
                    notificationPermissionDiv.style.display = 'none';
                    showNotification("–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã", "–¢–µ–ø–µ—Ä—å –≤—ã –±—É–¥–µ—Ç–µ –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç –±—É–¥–∏–ª—å–Ω–∏–∫–∞");
                } else {
                    notificationPermission = false;
                    notificationPermissionDiv.style.display = 'block';
                }
            });
        }
        
        // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(title, message) {
            if (!notificationPermission) {
                // –ï—Å–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ
                addMissedNotification(title, message);
                return;
            }
            
            const options = {
                body: message,
                icon: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMyIDhDNDEuOTUxIDggNTAgMTYuMDQ5IDUwIDI2VjQwTDU0IDQ0SDMySDZMMTAgNDBWMjZDMTAgMTYuMDQ5IDE4LjA0OSA4IDMyIDhaTTI0IDUwSDQwQzQwIDUzLjMxMzcgMzcuMzEzNyA1NiAzNCA1NkgyNkMyOS4zMTM3IDU2IDMyIDUzLjMxMzcgMzIgNTBaIiBmaWxsPSIjNEhGQjZCIi8+Cjwvc3ZnPg==',
                badge: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMyIDhDNDEuOTUxIDggNTAgMTYuMDQ5IDUwIDI2VjQwTDU0IDQ0SDMySDZMMTAgNDBWMjZDMTAgMTYuMDQ5IDE4LjA0OSA4IDMyIDhaTTI0IDUwSDQwQzQwIDUzLjMxMzcgMzcuMzEzNyA1NiAzNCA1NkgyNkMyOS4zMTM3IDU2IDMyIDUzLjMxMzcgMzIgNTBaIiBmaWxsPSIjNEhGQjZCIi8+Cjwvc3ZnPg==',
                tag: 'alarm-notification',
                requireInteraction: true
            };
            
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.ready.then(function(registration) {
                    registration.showNotification(title, options);
                });
            } else {
                const notification = new Notification(title, options);
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                notification.onclose = function() {
                    console.log("–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ");
                };
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤–∫–ª—é—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        enableNotificationsBtn.addEventListener('click', requestNotificationPermission);
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∑–≤—É–∫–æ–≤ –∏–∑ localStorage
        function loadCustomSounds() {
            const savedSounds = localStorage.getItem('customSounds');
            if (savedSounds) {
                customSounds = JSON.parse(savedSounds);
                updateCustomSoundsList();
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∑–≤—É–∫–æ–≤
        function updateCustomSoundsList() {
            customSoundsList.innerHTML = '';
            
            if (customSounds.length === 0) {
                customSoundsList.innerHTML = '<div class="custom-sound-item"><span class="sound-name">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∑–≤—É–∫–æ–≤</span></div>';
                return;
            }
            
            customSounds.forEach((sound, index) => {
                const soundElement = document.createElement('div');
                soundElement.className = 'custom-sound-item';
                soundElement.innerHTML = `
                    <span class="sound-name">${sound.name}</span>
                    <div class="sound-controls">
                        <button class="sound-btn play-sound" data-index="${index}" title="–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏">‚ñ∂Ô∏è</button>
                        <button class="sound-btn delete-sound" data-index="${index}" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button>
                    </div>
                `;
                customSoundsList.appendChild(soundElement);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è
            document.querySelectorAll('.play-sound').forEach(button => {
                button.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    playCustomSound(index);
                });
            });
            
            document.querySelectorAll('.delete-sound').forEach(button => {
                button.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    deleteCustomSound(index);
                });
            });
        }
        
        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∑–≤—É–∫–∞
        function playCustomSound(index) {
            if (index >= 0 && index < customSounds.length) {
                const sound = customSounds[index];
                const audio = new Audio(sound.data);
                audio.play().catch(e => {
                    console.log("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞:", e);
                    alert("–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∑–≤—É–∫. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞.");
                });
            }
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∑–≤—É–∫–∞
        function deleteCustomSound(index) {
            if (index >= 0 && index < customSounds.length) {
                if (confirm(`–£–¥–∞–ª–∏—Ç—å –∑–≤—É–∫ "${customSounds[index].name}"?`)) {
                    customSounds.splice(index, 1);
                    saveData();
                    updateCustomSoundsList();
                }
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
        audioUpload.addEventListener('change', function(e) {
            if (e.target.files.length > 0) {
                selectedFile = e.target.files[0];
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–º—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
                document.querySelector('.file-upload-label').textContent = `üìÅ ${selectedFile.name}`;
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–≤—É–∫–∞
        uploadSoundBtn.addEventListener('click', function() {
            if (!selectedFile) {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∑–≤—É–∫–æ–≤–æ–π —Ñ–∞–π–ª");
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const soundData = e.target.result;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 5MB)
                if (selectedFile.size > 5 * 1024 * 1024) {
                    alert("–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä - 5MB.");
                    return;
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∑–≤—É–∫ –≤ —Å–ø–∏—Å–æ–∫
                customSounds.push({
                    name: selectedFile.name,
                    data: soundData
                });
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
                saveData();
                updateCustomSoundsList();
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä —Ñ–∞–π–ª–∞
                selectedFile = null;
                audioUpload.value = '';
                document.querySelector('.file-upload-label').textContent = 'üìÅ –í—ã–±—Ä–∞—Ç—å –∑–≤—É–∫–æ–≤–æ–π —Ñ–∞–π–ª';
                
                alert("–ó–≤—É–∫ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!");
            };
            
            reader.readAsDataURL(selectedFile);
        });
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–¥–∏—É—Å–∞
        alarmRadius.addEventListener('input', function() {
            radiusValue.textContent = `${this.value} –º`;
        });
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.getAttribute('data-tab');
                
                // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É
                tab.classList.add('active');
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫–∞—Ä—Ç—É
        map.on('click', function(e) {
            const alarmName = document.getElementById('alarmName').value || `–°–∏–≥–Ω–∞–ª ${alarms.length + 1}`;
            const alarmMessage = document.getElementById('alarmMessage').value || "–í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ —Ü–µ–ª–∏!";
            const radius = parseInt(alarmRadius.value);
            const soundType = document.getElementById('alarmSound').value;
            const showNotification = document.getElementById('locationNotification').checked;
            
            createLocationAlarm(e.latlng, alarmName, alarmMessage, radius, soundType, showNotification);
        });
        
        // –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
        function createLocationAlarm(latlng, name, message, radius, soundType, showNotification) {
            const alarmId = 'alarm_' + Date.now();
            
            // –°–æ–∑–¥–∞–µ–º –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞
            const alarmCircle = L.circle(latlng, {
                color: '#4A6FA5',
                fillColor: '#4A6FA5',
                fillOpacity: 0.2,
                radius: radius
            }).addTo(map);
            
            const alarmMarker = L.marker(latlng).addTo(map).bindPopup(`
                <div style="text-align: center; padding: 10px;">
                    <h3 style="margin: 0 0 10px 0; color: #4A6FA5;">${name}</h3>
                    <p style="margin: 0;">${message}</p>
                    <p style="margin: 10px 0 0 0; font-size: 0.9em; color: #777;">–†–∞–¥–∏—É—Å: ${radius} –º</p>
                </div>
            `);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–∏–≥–Ω–∞–ª
            const alarm = {
                id: alarmId,
                type: 'location',
                name: name,
                message: message,
                latlng: latlng,
                radius: radius,
                soundType: soundType,
                circle: alarmCircle,
                marker: alarmMarker,
                active: true,
                showNotification: showNotification
            };
            
            alarms.push(alarm);
            updateAlarmsList();
            saveData();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
            alarmStatus.textContent = `–ì–µ–æ—Å–∏–≥–Ω–∞–ª "${name}" —Å–æ–∑–¥–∞–Ω!`;
            setTimeout(() => {
                alarmStatus.textContent = "–°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞";
            }, 3000);
        }
        
        // –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –±—É–¥–∏–ª—å–Ω–∏–∫–∞
        function createTimeAlarm() {
            const alarmName = document.getElementById('timeAlarmName').value || `–ë—É–¥–∏–ª—å–Ω–∏–∫ ${alarms.length + 1}`;
            const alarmMessage = document.getElementById('timeAlarmMessage').value || "–í—Ä–µ–º—è –ø—Ä–∏—à–ª–æ!";
            const alarmTime = document.getElementById('alarmTime').value;
            const repeatDays = document.getElementById('repeatDays').value;
            const soundType = document.getElementById('timeAlarmSound').value;
            const showNotification = document.getElementById('timeNotification').checked;
            
            if (!alarmTime) {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Ä–µ–º—è –¥–ª—è –±—É–¥–∏–ª—å–Ω–∏–∫–∞");
                return;
            }
            
            const alarmId = 'alarm_' + Date.now();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –±—É–¥–∏–ª—å–Ω–∏–∫
            const alarm = {
                id: alarmId,
                type: 'time',
                name: alarmName,
                message: alarmMessage,
                time: alarmTime,
                repeat: repeatDays,
                soundType: soundType,
                active: true,
                showNotification: showNotification
            };
            
            alarms.push(alarm);
            updateAlarmsList();
            saveData();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
            alarmStatus.textContent = `–ë—É–¥–∏–ª—å–Ω–∏–∫ "${alarmName}" –Ω–∞ ${alarmTime} —Å–æ–∑–¥–∞–Ω!`;
            setTimeout(() => {
                alarmStatus.textContent = "–°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞";
            }, 3000);
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –±—É–¥–∏–ª—å–Ω–∏–∫–∞
        createTimeAlarmBtn.addEventListener('click', createTimeAlarm);
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
        function updateAlarmsList() {
            alarmsList.innerHTML = '';
            activeAlarmsCount.textContent = alarms.length;
            
            if (alarms.length === 0) {
                alarmsList.innerHTML = '<div class="alarm-item"><span class="alarm-name">–ü–æ–∫–∞ –Ω–µ—Ç —Å–∏–≥–Ω–∞–ª–æ–≤</span></div>';
                return;
            }
            
            alarms.forEach(alarm => {
                const alarmElement = document.createElement('div');
                alarmElement.className = 'alarm-item';
                if (alarm === closestAlarm) {
                    alarmElement.classList.add('active-alarm');
                }
                
                let details = '';
                if (alarm.type === 'location') {
                    details = `${alarm.radius} –º`;
                } else if (alarm.type === 'time') {
                    details = `${alarm.time} (${getRepeatText(alarm.repeat)})`;
                }
                
                alarmElement.innerHTML = `
                    <div>
                        <div class="alarm-name">${alarm.name}</div>
                        <div class="alarm-details">${details}</div>
                    </div>
                    <button class="delete-alarm" data-id="${alarm.id}">√ó</button>
                `;
                
                alarmsList.appendChild(alarmElement);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —É–¥–∞–ª–µ–Ω–∏—è
            document.querySelectorAll('.delete-alarm').forEach(button => {
                button.addEventListener('click', function() {
                    const alarmId = this.getAttribute('data-id');
                    deleteAlarm(alarmId);
                });
            });
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è
        function getRepeatText(repeat) {
            switch(repeat) {
                case 'once': return '–æ–¥–∏–Ω —Ä–∞–∑';
                case 'daily': return '–µ–∂–µ–¥–Ω–µ–≤–Ω–æ';
                case 'weekdays': return '–ø–æ –±—É–¥–Ω—è–º';
                case 'weekends': return '–ø–æ –≤—ã—Ö–æ–¥–Ω—ã–º';
                default: return repeat;
            }
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞
        function deleteAlarm(alarmId) {
            const alarmIndex = alarms.findIndex(a => a.id === alarmId);
            if (alarmIndex !== -1) {
                // –ï—Å–ª–∏ —ç—Ç–æ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∏–≥–Ω–∞–ª, —É–¥–∞–ª—è–µ–º —Å –∫–∞—Ä—Ç—ã
                if (alarms[alarmIndex].type === 'location') {
                    map.removeLayer(alarms[alarmIndex].circle);
                    map.removeLayer(alarms[alarmIndex].marker);
                }
                
                // –£–¥–∞–ª—è–µ–º –∏–∑ –º–∞—Å—Å–∏–≤–∞
                alarms.splice(alarmIndex, 1);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
                updateAlarmsList();
                saveData();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
                alarmStatus.textContent = "–°–∏–≥–Ω–∞–ª —É–¥–∞–ª–µ–Ω";
                setTimeout(() => {
                    alarmStatus.textContent = "–°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞";
                }, 3000);
            }
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
        clearAlarmsBtn.addEventListener('click', function() {
            if (alarms.length === 0) return;
            
            if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–∏–≥–Ω–∞–ª—ã?")) {
                alarms.forEach(alarm => {
                    if (alarm.type === 'location') {
                        map.removeLayer(alarm.circle);
                        map.removeLayer(alarm.marker);
                    }
                });
                
                alarms = [];
                updateAlarmsList();
                closestAlarm = null;
                distanceInfo.textContent = "-";
                distanceInfo.classList.remove('active');
                saveData();
                
                alarmStatus.textContent = "–í—Å–µ —Å–∏–≥–Ω–∞–ª—ã —É–¥–∞–ª–µ–Ω—ã";
                setTimeout(() => {
                    alarmStatus.textContent = "–°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞";
                }, 3000);
            }
        });
        
        // –¢–µ—Å—Ç–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª
        testAlarmBtn.addEventListener('click', function() {
            triggerAlarm({
                name: "–¢–µ—Å—Ç–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª",
                message: "–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ!",
                soundType: "standard",
                showNotification: true
            });
        });
        
        // –ö–Ω–æ–ø–∫–∞ "–ù–∞–π—Ç–∏ –º–µ–Ω—è"
        locateUserBtn.addEventListener('click', function() {
            if (userMarker) {
                map.setView(userMarker.getLatLng(), 16);
            } else {
                getUserLocation();
            }
        });
        
        // –ö–Ω–æ–ø–∫–∞ "–°–ª–µ–¥–∏—Ç—å –∑–∞ –º–Ω–æ–π"
        trackUserBtn.addEventListener('click', function() {
            isTracking = !isTracking;
            if (isTracking) {
                trackUserBtn.style.background = 'var(--accent)';
                trackUserBtn.title = '–û—Ç–∫–ª—é—á–∏—Ç—å —Å–ª–µ–∂–µ–Ω–∏–µ';
                if (userMarker) {
                    map.setView(userMarker.getLatLng(), 16);
                }
            } else {
                trackUserBtn.style.background = 'var(--primary)';
                trackUserBtn.title = '–°–ª–µ–¥–∏—Ç—å –∑–∞ –º–Ω–æ–π';
            }
        });
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function getUserLocation() {
            if (navigator.geolocation) {
                // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–µ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –æ–¥–∏–Ω —Ä–∞–∑
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        updateUserPosition(position);
                    },
                    function(error) {
                        locationStatus.textContent = '–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è: ' + error.message;
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 0
                    }
                );
                
                // –ù–∞—á–∏–Ω–∞–µ–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è
                if (watchId) {
                    navigator.geolocation.clearWatch(watchId);
                }
                
                watchId = navigator.geolocation.watchPosition(
                    function(position) {
                        updateUserPosition(position);
                        checkLocationAlarms();
                    },
                    function(error) {
                        locationStatus.textContent = '–û—à–∏–±–∫–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è: ' + error.message;
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 1000
                    }
                );
            } else {
                locationStatus.textContent = '–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤–∞—à–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º';
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –∫–∞—Ä—Ç–µ
        function updateUserPosition(position) {
            const userLatLng = [position.coords.latitude, position.coords.longitude];
            const accuracy = position.coords.accuracy;
            
            // –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤—ã–π —Ä–∞–∑, —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∫–∞—Ä—Ç—É
            if (!userMarker) {
                map.setView(userLatLng, 16);
                
                // –°–æ–∑–¥–∞–µ–º –º–∞—Ä–∫–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∫–∞—Å—Ç–æ–º–Ω–æ–π –∏–∫–æ–Ω–∫–æ–π
                userMarker = L.marker(userLatLng, {
                    icon: L.divIcon({
                        className: 'user-location-marker',
                        html: '<div class="user-location-marker"></div>',
                        iconSize: [20, 20],
                        iconAnchor: [10, 10]
                    })
                }).addTo(map).bindPopup('–í–∞—à–µ —Ç–µ–∫—É—â–µ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ');
                
                // –°–æ–∑–¥–∞–µ–º –∫—Ä—É–≥ —Ç–æ—á–Ω–æ—Å—Ç–∏
                userAccuracyCircle = L.circle(userLatLng, {
                    color: '#FF6B6B',
                    fillColor: '#FF6B6B',
                    fillOpacity: 0.2,
                    radius: accuracy
                }).addTo(map);
            } else {
                userMarker.setLatLng(userLatLng);
                userAccuracyCircle.setLatLng(userLatLng);
                userAccuracyCircle.setRadius(accuracy);
            }
            
            // –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ —Å–ª–µ–∂–µ–Ω–∏–µ, —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∫–∞—Ä—Ç—É –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
            if (isTracking) {
                map.setView(userLatLng, map.getZoom());
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
            locationStatus.textContent = `–®–∏—Ä–æ—Ç–∞: ${userLatLng[0].toFixed(6)}, –î–æ–ª–≥–æ—Ç–∞: ${userLatLng[1].toFixed(6)}`;
            locationStatus.innerHTML += `<br>–¢–æ—á–Ω–æ—Å—Ç—å: ${Math.round(accuracy)} –º`;
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
        function checkLocationAlarms() {
            if (!userMarker || alarms.length === 0) return;
            
            const userLatLng = userMarker.getLatLng();
            let minDistance = Infinity;
            let closest = null;
            
            // –ù–∞—Ö–æ–¥–∏–º –±–ª–∏–∂–∞–π—à–∏–π —Å–∏–≥–Ω–∞–ª
            alarms.forEach(alarm => {
                if (alarm.type !== 'location') return;
                
                const distance = userLatLng.distanceTo(alarm.latlng);
                
                if (distance < minDistance) {
                    minDistance = distance;
                    closest = alarm;
                }
                
                // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ —Ä–∞–¥–∏—É—Å–µ —Å–∏–≥–Ω–∞–ª–∞
                if (distance <= alarm.radius) {
                    // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Å–∏–≥–Ω–∞–ª, –µ—Å–ª–∏ –æ–Ω –µ—â–µ –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
                    if (alarm.active) {
                        triggerAlarm(alarm);
                    }
                }
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–ª–∏–∂–∞–π—à–µ–º —Å–∏–≥–Ω–∞–ª–µ
            closestAlarm = closest;
            if (closest) {
                distanceInfo.textContent = `${Math.round(minDistance)} –º –¥–æ "${closest.name}"`;
                distanceInfo.classList.add('active');
            } else {
                distanceInfo.textContent = "-";
                distanceInfo.classList.remove('active');
            }
            
            updateAlarmsList();
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—É–¥–∏–ª—å–Ω–∏–∫–æ–≤
        function checkTimeAlarms() {
            const now = new Date();
            const currentTimeString = now.toTimeString().substring(0, 5);
            
            alarms.forEach(alarm => {
                if (alarm.type !== 'time') return;
                
                if (alarm.time === currentTimeString && alarm.active) {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
                    if (shouldTriggerTimeAlarm(alarm, now)) {
                        triggerAlarm(alarm);
                        
                        // –ï—Å–ª–∏ –±—É–¥–∏–ª—å–Ω–∏–∫ –Ω–∞ –æ–¥–∏–Ω —Ä–∞–∑, –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –µ–≥–æ
                        if (alarm.repeat === 'once') {
                            alarm.active = false;
                            saveData();
                        }
                    }
                }
            });
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞, –¥–æ–ª–∂–µ–Ω –ª–∏ —Å—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –±—É–¥–∏–ª—å–Ω–∏–∫
        function shouldTriggerTimeAlarm(alarm, now) {
            const dayOfWeek = now.getDay(); // 0 - –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ, 1 - –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, –∏ —Ç.–¥.
            
            switch(alarm.repeat) {
                case 'once':
                    return true;
                case 'daily':
                    return true;
                case 'weekdays':
                    return dayOfWeek >= 1 && dayOfWeek <= 5;
                case 'weekends':
                    return dayOfWeek === 0 || dayOfWeek === 6;
                default:
                    return true;
            }
        }
        
        // –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–∞
        function triggerAlarm(alarm) {
            // –í–∏–∑—É–∞–ª—å–Ω–æ–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ
            alarmStatus.textContent = `–°–ò–ì–ù–ê–õ: ${alarm.message}`;
            alarmStatus.classList.add('alarm-active');
            
            // –ó–≤—É–∫–æ–≤–æ–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ
            playAlarmSound(alarm.soundType);
            
            // –í–∏–±—Ä–∞—Ü–∏—è (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
            if (navigator.vibrate) {
                navigator.vibrate([200, 100, 200, 100, 200]);
            }
            
            // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)
            if (alarm.showNotification) {
                showNotification(alarm.name, alarm.message);
            } else {
                // –ï—Å–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω—ã –¥–ª—è —ç—Ç–æ–≥–æ –±—É–¥–∏–ª—å–Ω–∏–∫–∞, –≤—Å–µ —Ä–∞–≤–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–µ
                addMissedNotification(alarm.name, alarm.message);
            }
            
            // –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –≥–µ–æ–ª–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∏–≥–Ω–∞–ª –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è
            if (alarm.type === 'location') {
                alarm.active = false;
                setTimeout(() => {
                    alarm.active = true;
                    alarmStatus.classList.remove('alarm-active');
                    alarmStatus.textContent = "–°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞";
                }, 10000);
            } else {
                // –î–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—É–¥–∏–ª—å–Ω–∏–∫–æ–≤ —É–±–∏—Ä–∞–µ–º –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
                setTimeout(() => {
                    alarmStatus.classList.remove('alarm-active');
                    alarmStatus.textContent = "–°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞";
                }, 10000);
            }
        }
        
        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ —Å–∏–≥–Ω–∞–ª–∞
        function playAlarmSound(soundType) {
            if (soundType === 'custom' && customSounds.length > 0) {
                // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º —Å–ª—É—á–∞–π–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∑–≤—É–∫
                const randomIndex = Math.floor(Math.random() * customSounds.length);
                const sound = customSounds[randomIndex];
                const audio = new Audio(sound.data);
                audio.play().catch(e => console.log("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞:", e));
            } else {
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∏ –±—ã —Ä–∞–∑–Ω—ã–µ –∑–≤—É–∫–æ–≤—ã–µ —Ñ–∞–π–ª—ã
                try {
                    const audio = new Audio();
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑–æ–≤—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö —Ñ–∞–π–ª–æ–≤
                    console.log(`–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞: ${soundType}`);
                } catch(e) {
                    console.log("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞:", e);
                }
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toTimeString().substring(0, 8);
            currentTime.textContent = timeString;
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
        createAlarmBtn.addEventListener('click', function() {
            alert("–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç–µ, —á—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∏–≥–Ω–∞–ª");
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', function() {
            loadData();
            getUserLocation();
            checkNotificationPermission();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
            updateCurrentTime();
            currentTimeInterval = setInterval(updateCurrentTime, 1000);
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—É–¥–∏–ª—å–Ω–∏–∫–æ–≤
            setInterval(checkTimeAlarms, 1000);
            
            // –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ-—Å–∏–≥–Ω–∞–ª
            setTimeout(() => {
                if (alarms.length === 0) {
                    const demoLatLng = map.getCenter();
                    demoLatLng.lat += 0.005;
                    demoLatLng.lng += 0.005;
                    
                    createLocationAlarm(
                        demoLatLng, 
                        "–ü—Ä–∏–º–µ—Ä –≥–µ–æ—Å–∏–≥–Ω–∞–ª–∞", 
                        "–í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞!", 
                        300, 
                        "standard",
                        true
                    );
                }
            }, 2000);
        });
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('beforeunload', function() {
            saveData();
        });
    </script>
</body>
</html>