<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤—ã–π –§–æ—Ä—É–º | –°–æ–æ–±—â–µ—Å—Ç–≤–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>
    <style>
        :root {
            --primary-color: #0056b3;
            --secondary-color: #e9f2fa;
            --accent-color: #ff9900;
            --dark-color: #1a3c5e;
            --light-color: #f8f9fa;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --text-color: #333;
            --text-light: #666;
            --border-color: #ddd;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: #f5f7fa;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background-color: white;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
        }

        .logo-icon {
            color: var(--primary-color);
            font-size: 28px;
        }

        .logo-text {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark-color);
        }

        .logo-subtext {
            font-size: 14px;
            color: var(--text-light);
            font-weight: 400;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            font-weight: 600;
            font-size: 18px;
        }

        .user-name {
            font-weight: 500;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 25px;
        }

        nav a {
            text-decoration: none;
            color: var(--text-color);
            font-weight: 500;
            transition: color 0.3s;
            position: relative;
        }

        nav a:hover {
            color: var(--primary-color);
        }

        nav a.active {
            color: var(--primary-color);
        }

        nav a.active::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: var(--primary-color);
        }

        .auth-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 20px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--dark-color);
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
        }

        .btn-outline:hover {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-accent {
            background-color: var(--accent-color);
            color: white;
        }

        .btn-accent:hover {
            background-color: #e68a00;
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background-color: #218838;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background-color: #c82333;
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: #212529;
        }

        .btn-warning:hover {
            background-color: #e0a800;
        }

        .btn-small {
            padding: 4px 10px;
            font-size: 14px;
        }

        /* Main content */
        .main-content {
            display: flex;
            gap: 30px;
            margin-top: 30px;
        }

        /* Sidebar */
        .sidebar {
            width: 25%;
        }

        .sidebar-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 20px;
        }

        .sidebar-title {
            font-size: 18px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            color: var(--dark-color);
        }

        .categories-list, .tags-list {
            list-style: none;
        }

        .categories-list li, .tags-list li {
            margin-bottom: 10px;
        }

        .categories-list a, .tags-list a {
            text-decoration: none;
            color: var(--text-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 10px;
            border-radius: 4px;
            transition: all 0.3s;
        }

        .categories-list a:hover, .tags-list a:hover {
            background-color: var(--secondary-color);
            color: var(--primary-color);
        }

        .category-count, .tag-count {
            background-color: var(--secondary-color);
            color: var(--primary-color);
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 20px;
        }

        .stats {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px dashed var(--border-color);
        }

        .stat-value {
            font-weight: 700;
            color: var(--primary-color);
        }

        /* Forum content */
        .forum-content {
            width: 75%;
        }

        .welcome-banner {
            background: linear-gradient(135deg, var(--primary-color), var(--dark-color));
            color: white;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .welcome-text h2 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .welcome-text p {
            opacity: 0.9;
            max-width: 600px;
        }

        .ask-question-btn {
            background-color: var(--accent-color);
            color: white;
            padding: 12px 25px;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .forum-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .forum-title {
            font-size: 22px;
            color: var(--dark-color);
        }

        .sort-options select {
            padding: 8px 15px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            background-color: white;
            color: var(--text-color);
        }

        .questions-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .question-item {
            background-color: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 20px;
            transition: transform 0.3s;
        }

        .question-item:hover {
            transform: translateY(-3px);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .question-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-color);
            text-decoration: none;
            margin-bottom: 5px;
            display: block;
        }

        .question-title:hover {
            text-decoration: underline;
        }

        .question-category {
            display: inline-block;
            background-color: var(--secondary-color);
            color: var(--primary-color);
            font-size: 12px;
            padding: 3px 10px;
            border-radius: 20px;
            margin-bottom: 10px;
        }

        .question-preview {
            color: var(--text-light);
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .question-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            color: var(--text-light);
        }

        .question-author {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .author-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            font-weight: 600;
        }

        .question-meta {
            display: flex;
            gap: 20px;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .solved-badge {
            background-color: var(--success-color);
            color: white;
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 4px;
            display: inline-block;
            margin-left: 10px;
        }

        /* Question detail page */
        .question-detail {
            background-color: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 25px;
            margin-bottom: 25px;
        }

        .question-detail-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .question-detail-title {
            font-size: 24px;
            color: var(--dark-color);
            margin-bottom: 10px;
        }

        .question-detail-body {
            font-size: 16px;
            line-height: 1.7;
            margin-bottom: 25px;
        }

        .question-detail-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .question-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .tag {
            background-color: var(--secondary-color);
            color: var(--primary-color);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
        }

        .answers-section {
            margin-top: 30px;
        }

        .answers-header {
            font-size: 20px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            color: var(--dark-color);
        }

        .answer-item {
            background-color: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 15px;
            position: relative;
        }

        .answer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .answer-author {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .answer-body {
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .answer-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .answer-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .like-btn {
            background: none;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--text-light);
            transition: color 0.3s;
            padding: 5px 10px;
            border-radius: 4px;
        }

        .like-btn:hover {
            background-color: rgba(0, 86, 179, 0.1);
            color: var(--primary-color);
        }

        .like-btn.liked {
            color: var(--danger-color);
            background-color: rgba(220, 53, 69, 0.1);
        }

        .best-answer-badge {
            background-color: var(--success-color);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
            display: inline-block;
        }

        .no-data {
            text-align: center;
            padding: 40px;
            color: var(--text-light);
            font-size: 18px;
        }

        /* Real-time indicator */
        .real-time-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            background-color: var(--success-color);
            border-radius: 50%;
            margin-left: 5px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: white;
            border-radius: 8px;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            color: var(--dark-color);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-light);
        }

        .modal-body {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-family: 'Roboto', sans-serif;
            font-size: 16px;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        textarea.form-control {
            min-height: 150px;
            resize: vertical;
        }

        /* Alert messages */
        .alert {
            padding: 12px 20px;
            border-radius: 4px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .close-alert {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: inherit;
        }

        /* Loading indicator */
        .loading {
            text-align: center;
            padding: 20px;
            color: var(--text-light);
        }

        .spinner {
            border: 3px solid var(--secondary-color);
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Online users */
        .online-users {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 10px;
        }

        .online-user {
            display: flex;
            align-items: center;
            gap: 5px;
            background-color: var(--secondary-color);
            padding: 3px 8px;
            border-radius: 20px;
            font-size: 12px;
        }

        .online-dot {
            width: 8px;
            height: 8px;
            background-color: var(--success-color);
            border-radius: 50%;
        }

        /* Footer */
        footer {
            background-color: var(--dark-color);
            color: white;
            margin-top: 50px;
            padding: 40px 0 20px;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 30px;
        }

        .footer-column {
            flex: 1;
            min-width: 200px;
        }

        .footer-column h3 {
            font-size: 18px;
            margin-bottom: 20px;
            color: white;
        }

        .footer-column ul {
            list-style: none;
        }

        .footer-column ul li {
            margin-bottom: 10px;
        }

        .footer-column a {
            color: #ccc;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-column a:hover {
            color: white;
        }

        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #aaa;
            font-size: 14px;
        }

        /* Responsive */
        @media (max-width: 992px) {
            .main-content {
                flex-direction: column;
            }
            
            .sidebar, .forum-content {
                width: 100%;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .welcome-banner {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
            
            .question-footer, .question-detail-footer, .answer-footer {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .question-meta, .answer-actions {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <a href="#" class="logo" id="homeLink">
                    <i class="fas fa-oil-well logo-icon"></i>
                    <div>
                        <div class="logo-text">–ù–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤—ã–π –§–æ—Ä—É–º</div>
                        <div class="logo-subtext">–°–æ–æ–±—â–µ—Å—Ç–≤–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤</div>
                    </div>
                </a>
                
                <nav>
                    <ul>
                        <li><a href="#" id="navHome" class="active">–ì–ª–∞–≤–Ω–∞—è</a></li>
                        <li><a href="#" id="navQuestions">–í–æ–ø—Ä–æ—Å—ã</a></li>
                        <li><a href="#" id="navCategories">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a></li>
                        <li><a href="#" id="navMyQuestions">–ú–æ–∏ –≤–æ–ø—Ä–æ—Å—ã</a></li>
                    </ul>
                </nav>
                
                <div id="userSection">
                    <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ JavaScript -->
                </div>
            </div>
        </div>
    </header>

    <!-- Alert Container -->
    <div class="container" id="alertContainer"></div>

    <!-- Main Content -->
    <div class="container">
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="sidebar-card">
                    <h3 class="sidebar-title">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
                    <ul class="categories-list" id="categoriesList">
                        <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ JavaScript -->
                    </ul>
                </div>
                
                <div class="sidebar-card">
                    <h3 class="sidebar-title">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–µ–≥–∏</h3>
                    <div class="tags-list" id="tagsList">
                        <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ JavaScript -->
                    </div>
                </div>
                
                <div class="sidebar-card">
                    <h3 class="sidebar-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ñ–æ—Ä—É–º–∞</h3>
                    <div class="stats" id="forumStats">
                        <div class="stat-item">
                            <span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</span>
                            <span class="stat-value" id="statUsers">0</span>
                        </div>
                        <div class="stat-item">
                            <span>–í–æ–ø—Ä–æ—Å–æ–≤:</span>
                            <span class="stat-value" id="statQuestions">0</span>
                        </div>
                        <div class="stat-item">
                            <span>–û—Ç–≤–µ—Ç–æ–≤:</span>
                            <span class="stat-value" id="statAnswers">0</span>
                        </div>
                        <div class="stat-item">
                            <span>–†–µ—à–µ–Ω–∏–π:</span>
                            <span class="stat-value" id="statSolved">0</span>
                        </div>
                        <div class="stat-item">
                            <span>–û–Ω–ª–∞–π–Ω:</span>
                            <span class="stat-value" id="statOnline">0</span>
                        </div>
                        <div class="online-users" id="onlineUsersList">
                            <!-- –°–ø–∏—Å–æ–∫ –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
                        </div>
                    </div>
                </div>
            </aside>
            
            <!-- Forum Content -->
            <main class="forum-content">
                <div id="contentArea">
                    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å—Å—è -->
                </div>
            </main>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>–û —Ñ–æ—Ä—É–º–µ</h3>
                    <p>–°–æ–æ–±—â–µ—Å—Ç–≤–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤ –Ω–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤–æ–π –æ—Ç—Ä–∞—Å–ª–∏ –¥–ª—è –æ–±–º–µ–Ω–∞ –æ–ø—ã—Ç–æ–º, —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º –∏ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π.</p>
                </div>
                <div class="footer-column">
                    <h3>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã</h3>
                    <ul>
                        <li><a href="#" data-category="–ë—É—Ä–µ–Ω–∏–µ –∏ –¥–æ–±—ã—á–∞">–ë—É—Ä–µ–Ω–∏–µ –∏ –¥–æ–±—ã—á–∞</a></li>
                        <li><a href="#" data-category="–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Ñ—Ç–∏ –∏ –≥–∞–∑–∞">–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Ñ—Ç–∏ –∏ –≥–∞–∑–∞</a></li>
                        <li><a href="#" data-category="–≠–∫–æ–ª–æ–≥–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å">–≠–∫–æ–ª–æ–≥–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</a></li>
                        <li><a href="#" data-category="–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏">–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>–ü—Ä–∞–≤–∏–ª–∞</h3>
                    <ul>
                        <li><a href="#" id="rulesLink">–ü—Ä–∞–≤–∏–ª–∞ —Ñ–æ—Ä—É–º–∞</a></li>
                        <li><a href="#" id="privacyLink">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a></li>
                        <li><a href="#" id="helpLink">–ü–æ–º–æ—â—å</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
                    <ul>
                        <li><i class="fas fa-envelope"></i> info@oilgasforum.ru</li>
                        <li><i class="fas fa-phone"></i> +7 (495) 123-45-67</li>
                        <li><i class="fas fa-map-marker-alt"></i> –ú–æ—Å–∫–≤–∞, —É–ª. –ù–µ—Ñ—Ç—è–Ω–∏–∫–æ–≤, 15</li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                &copy; <span id="currentYear"></span> –ù–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤—ã–π –§–æ—Ä—É–º. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
            </div>
        </div>
    </footer>

    <!-- Modal –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞ -->
    <div class="modal" id="questionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–ó–∞–¥–∞—Ç—å –Ω–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å</h3>
                <button class="close-modal" id="closeQuestionModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="questionForm">
                    <div class="form-group">
                        <label for="questionTitle">–ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤–æ–ø—Ä–æ—Å–∞</label>
                        <input type="text" id="questionTitle" class="form-control" placeholder="–°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ –≤–æ–ø—Ä–æ—Å —á–µ—Ç–∫–æ –∏ —è—Å–Ω–æ" required>
                    </div>
                    <div class="form-group">
                        <label for="questionCategory">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                        <select id="questionCategory" class="form-control" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="questionDetails">–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="questionDetails" class="form-control" placeholder="–û–ø–∏—à–∏—Ç–µ –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É –∏–ª–∏ –≤–æ–ø—Ä–æ—Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ. –£–∫–∞–∂–∏—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç, —É–∂–µ –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –∏ –æ–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç." required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="questionTags">–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                        <input type="text" id="questionTags" class="form-control" placeholder="–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ, –±—É—Ä–µ–Ω–∏–µ, –Ω–∞—Å–æ—Å—ã">
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; padding: 12px;">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
    <div class="modal" id="registerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —Ñ–æ—Ä—É–º–µ</h3>
                <button class="close-modal" id="closeRegisterModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="registerForm">
                    <div class="form-group">
                        <label for="registerName">–ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è</label>
                        <input type="text" id="registerName" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="registerEmail">Email</label>
                        <input type="email" id="registerEmail" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">–ü–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤)</label>
                        <input type="password" id="registerPassword" class="form-control" minlength="6" required>
                    </div>
                    <div class="form-group">
                        <label for="registerCompany">–ö–æ–º–ø–∞–Ω–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                        <input type="text" id="registerCompany" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="registerPosition">–î–æ–ª–∂–Ω–æ—Å—Ç—å (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                        <input type="text" id="registerPosition" class="form-control">
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; padding: 12px;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal –¥–ª—è –≤—Ö–æ–¥–∞ -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–í—Ö–æ–¥ –Ω–∞ —Ñ–æ—Ä—É–º</h3>
                <button class="close-modal" id="closeLoginModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="loginPassword" class="form-control" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; padding: 12px;">–í–æ–π—Ç–∏</button>
                </form>
                <div style="text-align: center; margin-top: 15px;">
                    <p>–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" id="goToRegister">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal –¥–ª—è –æ—Ç–≤–µ—Ç–∞ -->
    <div class="modal" id="answerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å</h3>
                <button class="close-modal" id="closeAnswerModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="answerForm">
                    <div class="form-group">
                        <label for="answerText">–í–∞—à –æ—Ç–≤–µ—Ç</label>
                        <textarea id="answerText" class="form-control" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—à–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏–ª–∏ –¥–∞–π—Ç–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; padding: 12px;">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // üî• Firebase Configuration - –ó–ê–ú–ï–ù–ò–¢–ï –≠–¢–ò –î–ê–ù–ù–´–ï –ù–ê –°–í–û–ò!
        const firebaseConfig = {
            apiKey: "–í–ê–®_API_KEY",
            authDomain: "–í–ê–®_–ü–†–û–ï–ö–¢.firebaseapp.com",
            projectId: "–í–ê–®_–ü–†–û–ï–ö–¢_ID",
            storageBucket: "–í–ê–®_–ü–†–û–ï–ö–¢.appspot.com",
            messagingSenderId: "–í–ê–®_SENDER_ID",
            appId: "–í–ê–®_APP_ID",
            measurementId: "–í–ê–®_MEASUREMENT_ID"
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        const analytics = firebase.analytics();

        // –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Firebase
        class FirebaseForum {
            constructor() {
                this.currentUser = null;
                this.currentView = 'home';
                this.currentQuestionId = null;
                this.categories = [];
                this.onlineUsers = [];
                this.questionsListener = null;
                this.answersListeners = {};
                this.statsListener = null;
                this.onlineUsersListener = null;
                this.categoriesListener = null;
                this.init();
            }

            async init() {
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π –≥–æ–¥ –≤ —Ñ—É—Ç–µ—Ä–µ
                document.getElementById('currentYear').textContent = new Date().getFullYear();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Firebase
                await this.initializeFirebase();
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                await this.loadCategories();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                this.initUI();
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
                this.loadHomePage();
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                this.setupStatsListener();
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                this.setupOnlineUsersListener();
            }

            async initializeFirebase() {
                // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
                auth.onAuthStateChanged(async (user) => {
                    if (user) {
                        // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à–µ–ª –≤ —Å–∏—Å—Ç–µ–º—É
                        const userDoc = await db.collection('users').doc(user.uid).get();
                        
                        if (userDoc.exists) {
                            const userData = userDoc.data();
                            this.currentUser = {
                                id: user.uid,
                                email: user.email,
                                name: userData.name,
                                company: userData.company || '',
                                position: userData.position || '',
                                registrationDate: userData.registrationDate,
                                questionsCount: userData.questionsCount || 0,
                                answersCount: userData.answersCount || 0
                            };
                            
                            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –æ–Ω–ª–∞–π–Ω
                            await this.updateOnlineStatus(true);
                        }
                    } else {
                        // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã—à–µ–ª –∏–∑ —Å–∏—Å—Ç–µ–º—ã
                        this.currentUser = null;
                        await this.updateOnlineStatus(false);
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                    this.updateUserSection();
                });
            }

            async updateOnlineStatus(isOnline) {
                if (!this.currentUser) return;
                
                const userRef = db.collection('onlineUsers').doc(this.currentUser.id);
                
                if (isOnline) {
                    await userRef.set({
                        userId: this.currentUser.id,
                        userName: this.currentUser.name,
                        lastSeen: firebase.firestore.FieldValue.serverTimestamp(),
                        isOnline: true
                    });
                    
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                    this.onlineInterval = setInterval(() => {
                        if (this.currentUser) {
                            userRef.update({
                                lastSeen: firebase.firestore.FieldValue.serverTimestamp()
                            });
                        }
                    }, 30000); // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
                } else {
                    await userRef.delete();
                    if (this.onlineInterval) {
                        clearInterval(this.onlineInterval);
                    }
                }
            }

            setupOnlineUsersListener() {
                // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö
                this.onlineUsersListener = db.collection('onlineUsers')
                    .onSnapshot((snapshot) => {
                        this.onlineUsers = [];
                        snapshot.forEach((doc) => {
                            const user = doc.data();
                            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ–Ω–ª–∞–π–Ω, –µ—Å–ª–∏ –±—ã–ª –∞–∫—Ç–∏–≤–µ–Ω –º–µ–Ω–µ–µ 2 –º–∏–Ω—É—Ç –Ω–∞–∑–∞–¥
                            const lastSeen = user.lastSeen ? user.lastSeen.toDate() : new Date();
                            const twoMinutesAgo = new Date(Date.now() - 2 * 60 * 1000);
                            
                            if (lastSeen > twoMinutesAgo) {
                                this.onlineUsers.push(user);
                            }
                        });
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                        this.updateOnlineUsersDisplay();
                        this.updateStats();
                    });
            }

            updateOnlineUsersDisplay() {
                const onlineUsersList = document.getElementById('onlineUsersList');
                if (!onlineUsersList) return;
                
                if (this.onlineUsers.length > 0) {
                    let html = '';
                    this.onlineUsers.slice(0, 5).forEach(user => {
                        html += `
                            <div class="online-user">
                                <div class="online-dot"></div>
                                <span>${user.userName || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}</span>
                            </div>
                        `;
                    });
                    
                    if (this.onlineUsers.length > 5) {
                        html += `<div class="online-user">+${this.onlineUsers.length - 5}</div>`;
                    }
                    
                    onlineUsersList.innerHTML = html;
                } else {
                    onlineUsersList.innerHTML = '<div style="color: var(--text-light); font-size: 12px;">–ù–µ—Ç –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>';
                }
            }

            setupStatsListener() {
                // –°–ª—É—à–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
                this.statsListener = db.collection('stats').doc('forumStats')
                    .onSnapshot((doc) => {
                        if (doc.exists) {
                            const stats = doc.data();
                            this.updateStatsDisplay(stats);
                        }
                    });
            }

            updateStatsDisplay(stats) {
                document.getElementById('statUsers').textContent = stats.users || 0;
                document.getElementById('statQuestions').textContent = stats.questions || 0;
                document.getElementById('statAnswers').textContent = stats.answers || 0;
                document.getElementById('statSolved').textContent = stats.solved || 0;
                document.getElementById('statOnline').textContent = this.onlineUsers.length;
            }

            async loadCategories() {
                try {
                    const snapshot = await db.collection('categories').orderBy('name').get();
                    this.categories = [];
                    snapshot.forEach(doc => {
                        this.categories.push({
                            id: doc.id,
                            ...doc.data()
                        });
                    });
                    
                    // –ï—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–µ—Ç, —Å–æ–∑–¥–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ
                    if (this.categories.length === 0) {
                        await this.createDefaultCategories();
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:', error);
                    await this.createDefaultCategories();
                }
            }

            async createDefaultCategories() {
                const defaultCategories = [
                    { name: '–ë—É—Ä–µ–Ω–∏–µ –∏ –¥–æ–±—ã—á–∞', description: '–í–æ–ø—Ä–æ—Å—ã –ø–æ –±—É—Ä–µ–Ω–∏—é, –¥–æ–±—ã—á–µ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –º–µ—Å—Ç–æ—Ä–æ–∂–¥–µ–Ω–∏–π', count: 0 },
                    { name: '–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Ñ—Ç–∏ –∏ –≥–∞–∑–∞', description: '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –ù–ü–ó', count: 0 },
                    { name: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ', description: '–¢—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥—ã, –ª–æ–≥–∏—Å—Ç–∏–∫–∞, —Ö—Ä–∞–Ω–∏–ª–∏—â–∞', count: 0 },
                    { name: '–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', description: '–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ, –Ω–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è', count: 0 },
                    { name: '–≠–∫–æ–ª–æ–≥–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', description: '–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã, –æ—Ö—Ä–∞–Ω–∞ —Ç—Ä—É–¥–∞', count: 0 },
                    { name: '–≠–∫–æ–Ω–æ–º–∏–∫–∞ –∏ —Ä—ã–Ω–∫–∏', description: '–≠–∫–æ–Ω–æ–º–∏–∫–∞, —Ä—ã–Ω–∫–∏, —Ü–µ–Ω—ã, –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏', count: 0 },
                    { name: '–ù–æ—Ä–º–∞—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è', description: '–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã, —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—ã, –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ', count: 0 },
                    { name: '–ö–∞—Ä—å–µ—Ä–∞ –∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ', description: '–†–∞–±–æ—Ç–∞, –æ–±—É—á–µ–Ω–∏–µ, –∫–∞—Ä—å–µ—Ä–Ω—ã–π —Ä–æ—Å—Ç', count: 0 }
                ];
                
                for (const category of defaultCategories) {
                    await db.collection('categories').add(category);
                }
                
                await this.loadCategories();
            }

            initUI() {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                document.getElementById('homeLink').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.loadHomePage();
                });
                
                document.getElementById('navHome').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.loadHomePage();
                });
                
                document.getElementById('navQuestions').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.loadQuestionsPage();
                });
                
                document.getElementById('navCategories').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.loadCategoriesPage();
                });
                
                document.getElementById('navMyQuestions').addEventListener('click', (e) => {
                    e.preventDefault();
                    if (this.currentUser) {
                        this.loadMyQuestionsPage();
                    } else {
                        this.showAlert('–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–∞—à–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É', 'error');
                        this.showLoginModal();
                    }
                });
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
                document.getElementById('closeQuestionModal').addEventListener('click', () => {
                    document.getElementById('questionModal').classList.remove('active');
                });
                
                document.getElementById('closeRegisterModal').addEventListener('click', () => {
                    document.getElementById('registerModal').classList.remove('active');
                });
                
                document.getElementById('closeLoginModal').addEventListener('click', () => {
                    document.getElementById('loginModal').classList.remove('active');
                });
                
                document.getElementById('closeAnswerModal').addEventListener('click', () => {
                    document.getElementById('answerModal').classList.remove('active');
                });
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º
                document.getElementById('questionForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.submitQuestion();
                });
                
                document.getElementById('registerForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.registerUser();
                });
                
                document.getElementById('loginForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.loginUser();
                });
                
                document.getElementById('answerForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.submitAnswer();
                });
                
                // –°—Å—ã–ª–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
                document.getElementById('goToRegister').addEventListener('click', (e) => {
                    e.preventDefault();
                    document.getElementById('loginModal').classList.remove('active');
                    this.showRegisterModal();
                });
                
                // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ —Ñ–æ—Ä–º—É –≤–æ–ø—Ä–æ—Å–∞
                this.loadCategoriesToForm();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Å—ã–ª–æ–∫ –≤ —Ñ—É—Ç–µ—Ä–µ
                document.querySelectorAll('[data-category]').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const category = e.target.getAttribute('data-category');
                        this.loadCategoryPage(category);
                    });
                });
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥—Ä—É–≥–∏—Ö —Å—Å—ã–ª–æ–∫ –≤ —Ñ—É—Ç–µ—Ä–µ
                document.getElementById('rulesLink').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.showAlert('–ü—Ä–∞–≤–∏–ª–∞ —Ñ–æ—Ä—É–º–∞: 1. –£–≤–∞–∂–∞–π—Ç–µ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. 2. –ó–∞–¥–∞–≤–∞–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã. 3. –ü–æ–º–æ–≥–∞–π—Ç–µ –¥—Ä—É–≥–∏–º.', 'success');
                });
                
                document.getElementById('privacyLink').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.showAlert('–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏: –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã –∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º.', 'success');
                });
                
                document.getElementById('helpLink').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.showAlert('–ü–æ–º–æ—â—å: –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–º–æ—â–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞ info@oilgasforum.ru', 'success');
                });
            }

            loadCategoriesToForm() {
                const categorySelect = document.getElementById('questionCategory');
                if (!categorySelect) return;
                
                let optionsHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>';
                this.categories.forEach(category => {
                    optionsHTML += `<option value="${category.name}">${category.name}</option>`;
                });
                
                categorySelect.innerHTML = optionsHTML;
            }

            // –ó–∞–≥—Ä—É–∑–∫–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            loadHomePage() {
                this.currentView = 'home';
                this.updateNavigation();
                
                const contentArea = document.getElementById('contentArea');
                contentArea.innerHTML = `
                    <div class="welcome-banner">
                        <div class="welcome-text">
                            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –ù–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤—ã–π –§–æ—Ä—É–º!</h2>
                            <p>–ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã, –¥–µ–ª–∏—Ç–µ—Å—å –æ–ø—ã—Ç–æ–º, –Ω–∞—Ö–æ–¥–∏—Ç–µ —Ä–µ—à–µ–Ω–∏—è —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–∞–º–∏ –Ω–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤–æ–π –æ—Ç—Ä–∞—Å–ª–∏.</p>
                            <p><small><i class="fas fa-sync-alt"></i> –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</small></p>
                        </div>
                        <button class="btn btn-accent ask-question-btn" id="askQuestionBtn">
                            <i class="fas fa-question-circle"></i> –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å
                        </button>
                    </div>
                    
                    <div class="forum-header">
                        <h2 class="forum-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤–æ–ø—Ä–æ—Å—ã</h2>
                        <div class="sort-options">
                            <select id="sortQuestions">
                                <option value="new">–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</option>
                                <option value="popular">–°–Ω–∞—á–∞–ª–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ</option>
                                <option value="unanswered">–°–Ω–∞—á–∞–ª–∞ –±–µ–∑ –æ—Ç–≤–µ—Ç–æ–≤</option>
                                <option value="solved">–° —Ä–µ—à–µ–Ω–∏–µ–º</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="questions-list" id="questionsList">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤...</p>
                        </div>
                    </div>
                `;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å"
                document.getElementById('askQuestionBtn').addEventListener('click', () => {
                    if (this.currentUser) {
                        this.showQuestionModal();
                    } else {
                        this.showAlert('–î–ª—è –∑–∞–¥–∞–≤–∞–Ω–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É', 'error');
                        this.showLoginModal();
                    }
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
                document.getElementById('sortQuestions').addEventListener('change', (e) => {
                    this.setupQuestionsListener(e.target.value);
                });
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–ª—É—à–∞—Ç–µ–ª—å –≤–æ–ø—Ä–æ—Å–æ–≤
                this.setupQuestionsListener('new');
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç–µ–≥–∏ –≤ —Å–∞–π–¥–±–∞—Ä
                this.loadSidebarCategories();
                this.loadSidebarTags();
            }

            setupQuestionsListener(sortBy = 'new') {
                // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Å–ª—É—à–∞—Ç–µ–ª—å
                if (this.questionsListener) {
                    this.questionsListener();
                }
                
                let query = db.collection('questions');
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É
                if (sortBy === 'new') {
                    query = query.orderBy('createdAt', 'desc');
                } else if (sortBy === 'popular') {
                    query = query.orderBy('views', 'desc');
                } else if (sortBy === 'solved') {
                    query = query.where('solved', '==', true).orderBy('createdAt', 'desc');
                } else if (sortBy === 'unanswered') {
                    query = query.where('answersCount', '==', 0).orderBy('createdAt', 'desc');
                }
                
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
                query = query.limit(20);
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª—É—à–∞—Ç–µ–ª—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
                this.questionsListener = query.onSnapshot((snapshot) => {
                    const questionsList = document.getElementById('questionsList');
                    if (!questionsList) return;
                    
                    let questionsHTML = '';
                    
                    if (snapshot.size > 0) {
                        snapshot.forEach(doc => {
                            const question = doc.data();
                            const id = doc.id;
                            const solvedBadge = question.solved ? '<span class="solved-badge">–†–µ—à–µ–Ω–æ</span>' : '';
                            const date = question.createdAt ? question.createdAt.toDate().toLocaleDateString('ru-RU') : '–ù–µ–¥–∞–≤–Ω–æ';
                            
                            questionsHTML += `
                                <div class="question-item" data-id="${id}">
                                    <div class="question-header">
                                        <div>
                                            <a href="#" class="question-title view-question" data-id="${id}">${question.title} ${solvedBadge}</a>
                                            <span class="question-category">${question.category}</span>
                                            <p class="question-preview">${question.content.substring(0, 200)}...</p>
                                        </div>
                                    </div>
                                    <div class="question-footer">
                                        <div class="question-author">
                                            <div class="author-avatar">${question.userName ? question.userName.substring(0, 2).toUpperCase() : '–ê–ê'}</div>
                                            <div>
                                                <div>${question.userName || '–ê–Ω–æ–Ω–∏–º'}</div>
                                                <div>${date}</div>
                                            </div>
                                        </div>
                                        <div class="question-meta">
                                            <div class="meta-item">
                                                <i class="fas fa-comment"></i>
                                                <span>${question.answersCount || 0} –æ—Ç–≤–µ—Ç–æ–≤</span>
                                            </div>
                                            <div class="meta-item">
                                                <i class="fas fa-eye"></i>
                                                <span>${question.views || 0} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `;
                        });
                    } else {
                        questionsHTML = `
                            <div class="no-data">
                                <i class="fas fa-inbox" style="font-size: 48px; margin-bottom: 15px; opacity: 0.5;"></i>
                                <p>–í–æ–ø—Ä–æ—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
                                ${this.currentUser ? 
                                    `<button class="btn btn-primary" id="askFirstQuestionHome">–ó–∞–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å</button>` : 
                                    `<p>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å, —á—Ç–æ–±—ã –∑–∞–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å</p>`
                                }
                            </div>
                        `;
                    }
                    
                    questionsList.innerHTML = questionsHTML;
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
                    if (snapshot.size === 0 && this.currentUser) {
                        const askFirstButton = document.getElementById('askFirstQuestionHome');
                        if (askFirstButton) {
                            askFirstButton.addEventListener('click', () => {
                                this.showQuestionModal();
                            });
                        }
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–æ–ø—Ä–æ—Å–æ–≤
                    document.querySelectorAll('.view-question').forEach(link => {
                        link.addEventListener('click', (e) => {
                            e.preventDefault();
                            const questionId = e.target.getAttribute('data-id');
                            this.loadQuestionDetail(questionId);
                        });
                    });
                }, (error) => {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–æ–ø—Ä–æ—Å–æ–≤:', error);
                    const questionsList = document.getElementById('questionsList');
                    if (questionsList) {
                        questionsList.innerHTML = `
                            <div class="no-data">
                                <i class="fas fa-exclamation-triangle" style="font-size: 48px; margin-bottom: 15px; color: var(--danger-color);"></i>
                                <p>–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤–æ–ø—Ä–æ—Å–æ–≤</p>
                            </div>
                        `;
                    }
                });
            }

            async loadQuestionDetail(questionId) {
                this.currentQuestionId = questionId;
                this.currentView = 'question';
                this.updateNavigation();
                
                const contentArea = document.getElementById('contentArea');
                contentArea.innerHTML = `
                    <div id="questionDetailContent">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–∞...</p>
                        </div>
                    </div>
                `;
                
                try {
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
                    await db.collection('questions').doc(questionId).update({
                        views: firebase.firestore.FieldValue.increment(1)
                    });
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å–∞
                    const questionDoc = await db.collection('questions').doc(questionId).get();
                    
                    if (!questionDoc.exists) {
                        this.showAlert('–í–æ–ø—Ä–æ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                        this.loadHomePage();
                        return;
                    }
                    
                    const question = questionDoc.data();
                    const id = questionDoc.id;
                    
                    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–ª—É—à–∞—Ç–µ–ª—å –æ—Ç–≤–µ—Ç–æ–≤
                    this.setupAnswersListener(questionId, question);
                    
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–æ–ø—Ä–æ—Å–∞:', error);
                    this.showAlert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤–æ–ø—Ä–æ—Å–∞', 'error');
                    this.loadHomePage();
                }
            }

            setupAnswersListener(questionId, question) {
                // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Å–ª—É—à–∞—Ç–µ–ª—å –¥–ª—è —ç—Ç–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
                if (this.answersListeners[questionId]) {
                    this.answersListeners[questionId]();
                }
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª—É—à–∞—Ç–µ–ª—å –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
                this.answersListeners[questionId] = db.collection('answers')
                    .where('questionId', '==', questionId)
                    .orderBy('createdAt', 'desc')
                    .onSnapshot(async (snapshot) => {
                        const answers = [];
                        
                        for (const doc of snapshot.docs) {
                            const answer = doc.data();
                            const answerId = doc.id;
                            
                            // –ü–æ–ª—É—á–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤
                            const likesSnapshot = await db.collection('likes')
                                .where('answerId', '==', answerId)
                                .get();
                            
                            answer.id = answerId;
                            answer.likesCount = likesSnapshot.size;
                            
                            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ª–∞–π–∫–Ω—É–ª –ª–∏ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                            if (this.currentUser) {
                                const userLike = await db.collection('likes')
                                    .where('answerId', '==', answerId)
                                    .where('userId', '==', this.currentUser.id)
                                    .get();
                                
                                answer.hasLiked = !userLike.empty;
                            } else {
                                answer.hasLiked = false;
                            }
                            
                            answers.push(answer);
                        }
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–æ–ø—Ä–æ—Å–∞
                        this.updateQuestionDetail(question, answers);
                    }, (error) => {
                        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤:', error);
                    });
            }

            updateQuestionDetail(question, answers) {
                const date = question.createdAt ? question.createdAt.toDate().toLocaleDateString('ru-RU', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                }) : '–ù–µ–¥–∞–≤–Ω–æ';
                
                let tagsHTML = '';
                if (question.tags && question.tags.length > 0) {
                    tagsHTML = '<div class="question-tags">';
                    question.tags.forEach(tag => {
                        tagsHTML += `<span class="tag">${tag}</span>`;
                    });
                    tagsHTML += '</div>';
                }
                
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç—ã: —Å–Ω–∞—á–∞–ª–∞ –ª—É—á—à–∏–π, –ø–æ—Ç–æ–º –ø–æ –ª–∞–π–∫–∞–º, –ø–æ—Ç–æ–º –ø–æ –¥–∞—Ç–µ
                answers.sort((a, b) => {
                    if (a.isBest && !b.isBest) return -1;
                    if (!a.isBest && b.isBest) return 1;
                    if (a.likesCount !== b.likesCount) return b.likesCount - a.likesCount;
                    return b.createdAt - a.createdAt;
                });
                
                let answersHTML = '';
                if (answers.length > 0) {
                    answers.forEach(answer => {
                        const answerDate = answer.createdAt ? answer.createdAt.toDate().toLocaleDateString('ru-RU', {
                            day: 'numeric',
                            month: 'long',
                            year: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                        }) : '–ù–µ–¥–∞–≤–Ω–æ';
                        
                        const bestBadge = answer.isBest ? '<span class="best-answer-badge">–õ—É—á—à–∏–π –æ—Ç–≤–µ—Ç</span>' : '';
                        const likeClass = answer.hasLiked ? 'liked' : '';
                        
                        answersHTML += `
                            <div class="answer-item" data-id="${answer.id}">
                                <div class="answer-header">
                                    <div class="answer-author">
                                        <div class="author-avatar">${answer.userName ? answer.userName.substring(0, 2).toUpperCase() : '–ê–ê'}</div>
                                        <div>
                                            <div>${answer.userName || '–ê–Ω–æ–Ω–∏–º'}</div>
                                            <div>${answerDate}</div>
                                        </div>
                                    </div>
                                    ${bestBadge}
                                </div>
                                <div class="answer-body">
                                    ${answer.content}
                                </div>
                                <div class="answer-footer">
                                    <div class="answer-actions">
                                        ${!question.solved && this.currentUser && this.currentUser.id === question.userId ? 
                                            `<button class="btn btn-success btn-small mark-best-answer" data-id="${answer.id}">
                                                <i class="fas fa-check"></i> –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ª—É—á—à–∏–π
                                            </button>` : ''}
                                        ${answer.isBest ? '<span class="text-success"><i class="fas fa-check-circle"></i> –≠—Ç–æ—Ç –æ—Ç–≤–µ—Ç –æ—Ç–º–µ—á–µ–Ω –∫–∞–∫ –ª—É—á—à–∏–π</span>' : ''}
                                        ${this.currentUser ? 
                                            `<button class="like-btn ${likeClass}" data-id="${answer.id}">
                                                <i class="fas fa-thumbs-up"></i> <span class="like-count">${answer.likesCount}</span>
                                            </button>` : 
                                            `<div class="meta-item">
                                                <i class="fas fa-thumbs-up"></i>
                                                <span>${answer.likesCount}</span>
                                            </div>`
                                        }
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                } else {
                    answersHTML = `
                        <div class="no-data">
                            <i class="fas fa-comments" style="font-size: 48px; margin-bottom: 15px; opacity: 0.5;"></i>
                            <p>–ù–∞ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ—Ç–≤–µ—Ç–æ–≤</p>
                            <p>–ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –æ—Ç–≤–µ—Ç–∏—Ç!</p>
                        </div>
                    `;
                }
                
                const questionDetailContent = document.getElementById('questionDetailContent');
                questionDetailContent.innerHTML = `
                    <div class="question-detail">
                        <div class="question-detail-header">
                            <h1 class="question-detail-title">${question.title}</h1>
                            <span class="question-category">${question.category}</span>
                            ${question.solved ? '<span class="solved-badge" style="margin-left: 10px;">–†–µ—à–µ–Ω–æ</span>' : ''}
                        </div>
                        
                        <div class="question-detail-body">
                            ${question.content}
                        </div>
                        
                        ${tagsHTML}
                        
                        <div class="question-detail-footer">
                            <div class="question-author">
                                <div class="author-avatar">${question.userName ? question.userName.substring(0, 2).toUpperCase() : '–ê–ê'}</div>
                                <div>
                                    <div>${question.userName || '–ê–Ω–æ–Ω–∏–º'}</div>
                                    <div>${date}</div>
                                </div>
                            </div>
                            <div class="question-meta">
                                <div class="meta-item">
                                    <i class="fas fa-eye"></i>
                                    <span>${question.views || 0} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</span>
                                </div>
                                <div class="meta-item">
                                    <i class="fas fa-comment"></i>
                                    <span>${question.answersCount || 0} –æ—Ç–≤–µ—Ç–æ–≤</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="answers-section">
                        <h2 class="answers-header">–û—Ç–≤–µ—Ç—ã (${question.answersCount || 0}) <small><i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</small></h2>
                        ${answersHTML}
                        
                        <div style="margin-top: 30px;">
                            <h3>–í–∞—à –æ—Ç–≤–µ—Ç</h3>
                            ${this.currentUser ? 
                                `<button class="btn btn-primary" id="addAnswerBtn">
                                    <i class="fas fa-reply"></i> –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç
                                </button>` :
                                `<p>–ß—Ç–æ–±—ã –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å, <a href="#" id="loginToAnswer">–≤–æ–π–¥–∏—Ç–µ</a> –∏–ª–∏ <a href="#" id="registerToAnswer">–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</a></p>`
                            }
                        </div>
                    </div>
                `;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
                if (this.currentUser) {
                    document.getElementById('addAnswerBtn').addEventListener('click', () => {
                        this.showAnswerModal();
                    });
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ª–∞–π–∫–æ–≤
                    document.querySelectorAll('.like-btn').forEach(button => {
                        button.addEventListener('click', async (e) => {
                            const answerId = e.target.getAttribute('data-id') || e.target.closest('.like-btn').getAttribute('data-id');
                            await this.toggleLike(answerId);
                        });
                    });
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏ –ª—É—á—à–µ–≥–æ –æ—Ç–≤–µ—Ç–∞
                    document.querySelectorAll('.mark-best-answer').forEach(button => {
                        button.addEventListener('click', async (e) => {
                            const answerId = e.target.getAttribute('data-id') || e.target.closest('.mark-best-answer').getAttribute('data-id');
                            await this.markBestAnswer(answerId);
                        });
                    });
                } else {
                    document.getElementById('loginToAnswer').addEventListener('click', (e) => {
                        e.preventDefault();
                        this.showLoginModal();
                    });
                    
                    document.getElementById('registerToAnswer').addEventListener('click', (e) => {
                        e.preventDefault();
                        this.showRegisterModal();
                    });
                }
            }

            async toggleLike(answerId) {
                if (!this.currentUser) {
                    this.showAlert('–î–ª—è –æ—Ü–µ–Ω–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É', 'error');
                    this.showLoginModal();
                    return;
                }
                
                try {
                    const likeRef = db.collection('likes')
                        .where('answerId', '==', answerId)
                        .where('userId', '==', this.currentUser.id);
                    
                    const snapshot = await likeRef.get();
                    
                    if (snapshot.empty) {
                        // –î–æ–±–∞–≤–ª—è–µ–º –ª–∞–π–∫
                        await db.collection('likes').add({
                            answerId: answerId,
                            userId: this.currentUser.id,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        });
                        
                        this.showAlert('–û—Ç–≤–µ—Ç –æ—Ç–º–µ—á–µ–Ω –∫–∞–∫ –ø–æ–ª–µ–∑–Ω—ã–π!', 'success');
                    } else {
                        // –£–¥–∞–ª—è–µ–º –ª–∞–π–∫
                        await snapshot.docs[0].ref.delete();
                        this.showAlert('–û—Ü–µ–Ω–∫–∞ —É–¥–∞–ª–µ–Ω–∞', 'success');
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ü–µ–Ω–∫–µ –æ—Ç–≤–µ—Ç–∞:', error);
                    this.showAlert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ü–µ–Ω–∫–µ –æ—Ç–≤–µ—Ç–∞', 'error');
                }
            }

            async markBestAnswer(answerId) {
                if (!this.currentUser) return;
                
                try {
                    // –ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç
                    const answerDoc = await db.collection('answers').doc(answerId).get();
                    if (!answerDoc.exists) return;
                    
                    const answer = answerDoc.data();
                    const questionId = answer.questionId;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –≤–æ–ø—Ä–æ—Å
                    await db.collection('questions').doc(questionId).update({
                        solved: true,
                        bestAnswerId: answerId
                    });
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç
                    await db.collection('answers').doc(answerId).update({
                        isBest: true
                    });
                    
                    this.showAlert('–û—Ç–≤–µ—Ç –æ—Ç–º–µ—á–µ–Ω –∫–∞–∫ –ª—É—á—à–∏–π! –í–æ–ø—Ä–æ—Å –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ —Ä–µ—à–µ–Ω–Ω—ã–π.', 'success');
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–º–µ—Ç–∫–µ –ª—É—á—à–µ–≥–æ –æ—Ç–≤–µ—Ç–∞:', error);
                    this.showAlert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–º–µ—Ç–∫–µ –ª—É—á—à–µ–≥–æ –æ—Ç–≤–µ—Ç–∞', 'error');
                }
            }

            async submitQuestion() {
                if (!this.currentUser) {
                    this.showAlert('–î–ª—è –∑–∞–¥–∞–≤–∞–Ω–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É', 'error');
                    this.showLoginModal();
                    return;
                }
                
                const title = document.getElementById('questionTitle').value.trim();
                const category = document.getElementById('questionCategory').value;
                const content = document.getElementById('questionDetails').value.trim();
                const tagsInput = document.getElementById('questionTags').value.trim();
                
                if (!title || !category || !content) {
                    this.showAlert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
                    return;
                }
                
                const tags = tagsInput ? tagsInput.split(',').map(tag => tag.trim()).filter(tag => tag.length > 0) : [];
                
                try {
                    // –°–æ–∑–¥–∞–µ–º –≤–æ–ø—Ä–æ—Å
                    const questionRef = await db.collection('questions').add({
                        title,
                        category,
                        content,
                        tags,
                        userId: this.currentUser.id,
                        userName: this.currentUser.name,
                        views: 0,
                        answersCount: 0,
                        solved: false,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                    const categoryDoc = await db.collection('categories')
                        .where('name', '==', category)
                        .limit(1)
                        .get();
                    
                    if (!categoryDoc.empty) {
                        const catRef = categoryDoc.docs[0].ref;
                        await catRef.update({
                            count: firebase.firestore.FieldValue.increment(1)
                        });
                    }
                    
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    await db.collection('users').doc(this.currentUser.id).update({
                        questionsCount: firebase.firestore.FieldValue.increment(1)
                    });
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    await this.updateForumStats();
                    
                    this.showAlert('–í–∞—à –≤–æ–ø—Ä–æ—Å —É—Å–ø–µ—à–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω! –û–Ω –ø–æ—è–≤–∏—Ç—Å—è —É –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.', 'success');
                    document.getElementById('questionModal').classList.remove('active');
                    document.getElementById('questionForm').reset();
                    
                    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –≤–æ–ø—Ä–æ—Å—ã
                    this.setupQuestionsListener('new');
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–∞:', error);
                    this.showAlert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤–æ–ø—Ä–æ—Å–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.', 'error');
                }
            }

            async submitAnswer() {
                if (!this.currentUser) {
                    this.showAlert('–î–ª—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É', 'error');
                    this.showLoginModal();
                    return;
                }
                
                if (!this.currentQuestionId) {
                    this.showAlert('–û—à–∏–±–∫–∞: –≤–æ–ø—Ä–æ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                    return;
                }
                
                const content = document.getElementById('answerText').value.trim();
                
                if (!content) {
                    this.showAlert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞', 'error');
                    return;
                }
                
                try {
                    // –°–æ–∑–¥–∞–µ–º –æ—Ç–≤–µ—Ç
                    await db.collection('answers').add({
                        questionId: this.currentQuestionId,
                        content,
                        userId: this.currentUser.id,
                        userName: this.currentUser.name,
                        isBest: false,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –æ—Ç–≤–µ—Ç–æ–≤ –≤ –≤–æ–ø—Ä–æ—Å–µ
                    await db.collection('questions').doc(this.currentQuestionId).update({
                        answersCount: firebase.firestore.FieldValue.increment(1)
                    });
                    
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    await db.collection('users').doc(this.currentUser.id).update({
                        answersCount: firebase.firestore.FieldValue.increment(1)
                    });
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    await this.updateForumStats();
                    
                    this.showAlert('–í–∞—à –æ—Ç–≤–µ—Ç —É—Å–ø–µ—à–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω! –û–Ω –ø–æ—è–≤–∏—Ç—Å—è —É –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.', 'success');
                    document.getElementById('answerModal').classList.remove('active');
                    document.getElementById('answerForm').reset();
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –æ—Ç–≤–µ—Ç–∞:', error);
                    this.showAlert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.', 'error');
                }
            }

            async updateForumStats() {
                try {
                    // –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    const usersCount = await this.getCollectionCount('users');
                    const questionsCount = await this.getCollectionCount('questions');
                    const answersCount = await this.getCollectionCount('answers');
                    
                    // –ü–æ–ª—É—á–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—à–µ–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
                    const solvedQuery = await db.collection('questions')
                        .where('solved', '==', true)
                        .get();
                    const solvedCount = solvedQuery.size;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    await db.collection('stats').doc('forumStats').set({
                        users: usersCount,
                        questions: questionsCount,
                        answers: answersCount,
                        solved: solvedCount,
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
                }
            }

            async getCollectionCount(collectionName) {
                // –î–ª—è –±–æ–ª—å—à–∏—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç
                const snapshot = await db.collection(collectionName)
                    .limit(1000)
                    .get();
                return snapshot.size;
            }

            async registerUser() {
                const name = document.getElementById('registerName').value.trim();
                const email = document.getElementById('registerEmail').value.trim();
                const password = document.getElementById('registerPassword').value;
                const company = document.getElementById('registerCompany').value.trim();
                const position = document.getElementById('registerPosition').value.trim();
                
                if (!name || !email || !password) {
                    this.showAlert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
                    return;
                }
                
                if (password.length < 6) {
                    this.showAlert('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤', 'error');
                    return;
                }
                
                try {
                    // –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Firebase Authentication
                    const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                    const user = userCredential.user;
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Firestore
                    await db.collection('users').doc(user.uid).set({
                        name,
                        email,
                        company: company || '',
                        position: position || '',
                        registrationDate: firebase.firestore.FieldValue.serverTimestamp(),
                        questionsCount: 0,
                        answersCount: 0
                    });
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    await this.updateForumStats();
                    
                    this.showAlert('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Ñ–æ—Ä—É–º!', 'success');
                    document.getElementById('registerModal').classList.remove('active');
                    document.getElementById('registerForm').reset();
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error);
                    
                    let errorMessage = '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏';
                    if (error.code === 'auth/email-already-in-use') {
                        errorMessage = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω';
                    } else if (error.code === 'auth/weak-password') {
                        errorMessage = '–ü–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º —Å–ª–∞–±—ã–π';
                    } else if (error.code === 'auth/invalid-email') {
                        errorMessage = '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email';
                    }
                    
                    this.showAlert(errorMessage, 'error');
                }
            }

            async loginUser() {
                const email = document.getElementById('loginEmail').value.trim();
                const password = document.getElementById('loginPassword').value;
                
                if (!email || !password) {
                    this.showAlert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ email –∏ –ø–∞—Ä–æ–ª—å', 'error');
                    return;
                }
                
                try {
                    await auth.signInWithEmailAndPassword(email, password);
                    this.showAlert('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
                    document.getElementById('loginModal').classList.remove('active');
                    document.getElementById('loginForm').reset();
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ:', error);
                    
                    let errorMessage = '–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ';
                    if (error.code === 'auth/user-not-found') {
                        errorMessage = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω';
                    } else if (error.code === 'auth/wrong-password') {
                        errorMessage = '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å';
                    } else if (error.code === 'auth/invalid-email') {
                        errorMessage = '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email';
                    }
                    
                    this.showAlert(errorMessage, 'error');
                }
            }

            async logoutUser() {
                try {
                    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –æ–Ω–ª–∞–π–Ω
                    if (this.currentUser) {
                        await db.collection('onlineUsers').doc(this.currentUser.id).delete();
                        if (this.onlineInterval) {
                            clearInterval(this.onlineInterval);
                        }
                    }
                    
                    await auth.signOut();
                    this.showAlert('–í—ã —É—Å–ø–µ—à–Ω–æ –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã', 'success');
                    
                    // –ï—Å–ª–∏ –º—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ "–ú–æ–∏ –≤–æ–ø—Ä–æ—Å—ã", –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é
                    if (this.currentView === 'myquestions') {
                        this.loadHomePage();
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ:', error);
                    this.showAlert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ —Å–∏—Å—Ç–µ–º—ã', 'error');
                }
            }

            // –û—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã (loadQuestionsPage, loadCategoriesPage, loadMyQuestionsPage –∏ —Ç.–¥.)
            // –±—É–¥—É—Ç –ø–æ—Ö–æ–∂–∏ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é –≤–µ—Ä—Å–∏—é, –Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è Firebase
            
            // –î–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏ –æ—Å—Ç–∞–≤–ª—é –∏—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∫–æ–¥–æ–º

            updateUserSection() {
                const userSection = document.getElementById('userSection');
                
                if (this.currentUser) {
                    userSection.innerHTML = `
                        <div class="user-info">
                            <div class="user-avatar">${this.currentUser.name.substring(0, 2).toUpperCase()}</div>
                            <div>
                                <div class="user-name">${this.currentUser.name}</div>
                                <div style="font-size: 12px; color: var(--text-light);">${this.currentUser.position || ''}</div>
                            </div>
                            <button class="btn btn-outline btn-small" id="logoutBtn">–í—ã–π—Ç–∏</button>
                        </div>
                    `;
                    
                    document.getElementById('logoutBtn').addEventListener('click', () => {
                        this.logoutUser();
                    });
                } else {
                    userSection.innerHTML = `
                        <div class="auth-buttons">
                            <button class="btn btn-outline" id="loginBtn">–í–æ–π—Ç–∏</button>
                            <button class="btn btn-primary" id="registerBtn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                        </div>
                    `;
                    
                    document.getElementById('loginBtn').addEventListener('click', () => {
                        this.showLoginModal();
                    });
                    
                    document.getElementById('registerBtn').addEventListener('click', () => {
                        this.showRegisterModal();
                    });
                }
            }

            updateNavigation() {
                document.querySelectorAll('nav a').forEach(link => {
                    link.classList.remove('active');
                });
                
                if (this.currentView === 'home') {
                    document.getElementById('navHome').classList.add('active');
                } else if (this.currentView === 'questions') {
                    document.getElementById('navQuestions').classList.add('active');
                } else if (this.currentView === 'categories' || this.currentView === 'category') {
                    document.getElementById('navCategories').classList.add('active');
                } else if (this.currentView === 'myquestions') {
                    document.getElementById('navMyQuestions').classList.add('active');
                }
            }

            showQuestionModal() {
                document.getElementById('questionModal').classList.add('active');
            }

            showRegisterModal() {
                document.getElementById('registerModal').classList.add('active');
            }

            showLoginModal() {
                document.getElementById('loginModal').classList.add('active');
            }

            showAnswerModal() {
                document.getElementById('answerModal').classList.add('active');
            }

            showAlert(message, type = 'success') {
                const alertContainer = document.getElementById('alertContainer');
                
                const alert = document.createElement('div');
                alert.className = `alert alert-${type === 'error' ? 'error' : 'success'}`;
                alert.innerHTML = `
                    <span>${message}</span>
                    <button class="close-alert">&times;</button>
                `;
                
                alertContainer.appendChild(alert);
                
                alert.querySelector('.close-alert').addEventListener('click', () => {
                    alert.remove();
                });
                
                setTimeout(() => {
                    if (alert.parentNode) {
                        alert.remove();
                    }
                }, 5000);
            }

            loadSidebarCategories() {
                const categoriesList = document.getElementById('categoriesList');
                if (!categoriesList) return;
                
                let categoriesHTML = '';
                this.categories.forEach(category => {
                    categoriesHTML += `
                        <li><a href="#" data-category="${category.name}">${category.name} <span class="category-count">${category.count || 0}</span></a></li>
                    `;
                });
                
                categoriesList.innerHTML = categoriesHTML;
                
                categoriesList.querySelectorAll('a').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const category = e.target.getAttribute('data-category') || e.target.closest('a').getAttribute('data-category');
                        this.loadCategoryPage(category);
                    });
                });
            }

            loadSidebarTags() {
                const tagsList = document.getElementById('tagsList');
                if (!tagsList) return;
                
                // –í —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏ —Ç–µ–≥–∏ –±—É–¥—É—Ç —Å—Ç–∞—Ç–∏—á–Ω—ã–º–∏
                const tags = [
                    { name: '—Å–∫–≤–∞–∂–∏–Ω–∞', count: 0 },
                    { name: '–≥–µ–æ–ª–æ–≥–æ—Ä–∞–∑–≤–µ–¥–∫–∞', count: 0 },
                    { name: '–Ω–µ—Ñ—Ç–µ–ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞', count: 0 },
                    { name: '–≥–∞–∑–ø—Ä–æ–≤–æ–¥', count: 0 },
                    { name: '–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ', count: 0 },
                    { name: '—ç–∫–æ–ª–æ–≥–∏—è', count: 0 },
                    { name: '—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', count: 0 },
                    { name: '–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', count: 0 }
                ];
                
                let tagsHTML = '';
                tags.forEach(tag => {
                    tagsHTML += `<a href="#">${tag.name} <span class="tag-count">${tag.count}</span></a>`;
                });
                
                tagsList.innerHTML = tagsHTML;
            }

            loadQuestionsPage() {
                // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞ loadHomePage, –Ω–æ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤ 20 –≤–æ–ø—Ä–æ—Å–æ–≤
                // –∏ —Å –¥—Ä—É–≥–∏–º ID —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            }

            loadCategoriesPage() {
                // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            }

            loadCategoryPage(categoryName) {
                // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            }

            loadMyQuestionsPage() {
                // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã "–ú–æ–∏ –≤–æ–ø—Ä–æ—Å—ã"
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä—É–º–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            window.forum = new FirebaseForum();
        });
    </script>
</body>
</html>